<!DOCTYPE html>
<html lang="en" class="notranslate">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- ููุน ุงูุชุฑุฌูุฉ ูู ุงููุชุตูุญุงุช -->
  <meta name="google" content="notranslate">

  <title>Reading Comprehension Quiz</title>

<style>
/* ููุน ุงูุณุญุจ ูุชุญุฏูุซ ุงูุตูุญุฉ ุนูู ุงูููุจุงูู */
html, body {
  overscroll-behavior: none; /* ูููุน pull-to-refresh */
  touch-action: pan-x pan-y; /* ูุณูุญ ุจุงูุชูุฑูุฑ ุฏุงุฎู ุงููุญุชูู ููุท */
  -webkit-overflow-scrolling: auto; /* ุชุนุทูู ุงูุชูุฑูุฑ ุงูุณูุณ ุงูุงูุชุฑุงุถู */
}
</style>

<script>
// ููุน ุงูุณุญุจ ููุฃุณูู ูุฅุนุงุฏุฉ ุชุญููู ุงูุตูุญุฉ (pull-to-refresh)
let lastTouchY = 0;
let maybePreventPullToRefresh = false;

document.addEventListener('touchstart', function(e) {
  if (e.touches.length !== 1) return;
  lastTouchY = e.touches[0].clientY;
  maybePreventPullToRefresh = window.pageYOffset === 0;
}, {passive: true});

document.addEventListener('touchmove', function(e) {
  const touchY = e.touches[0].clientY;
  const touchYDelta = touchY - lastTouchY;
  lastTouchY = touchY;

  if (maybePreventPullToRefresh) {
    // ุฅุฐุง ุงููุณุชุฎุฏู ูุณุญุจ ูุฃุณูู ูู ุฃุนูู ุงูุตูุญุฉ
    if (touchYDelta > 0) {
      e.preventDefault();
    }
  }
}, {passive: false});
</script>



  <style>
    body {
      font-family: Arial, sans-serif;
      text-align: center;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-start;
      margin: 0;
      background: #1e1e2e;
      color: white;
    }

    .container {
      margin-top: 5px;
      width: 95%;
      max-width: 1200px;
      background: #282a36;
      padding: 10px 30px 30px;
      border-radius: 10px;
      box-shadow: 0px 0px 15px rgba(0, 0, 0, 0.5);
      text-align: left;
    }

    h1, h2, p { margin-top: 0; }

    .question {
      font-weight: bold;
      font-size: 30px;
      margin-bottom: 20px;
    }

    .options label {
      display: block;
      padding: 10px;
    }

    .btn {
      background: #ff5555;
      color: white;
      border: none;
      padding: 12px 25px;
      cursor: pointer;
      border-radius: 5px;
      margin-top: 200px;
      font-size: 18px;
      display: block;
    }

    .btn:hover { background: #ff79c6; }

    .result-screen {
      display: none;
      background: #44475a;
      padding: 30px;
      border-radius: 10px;
      text-align: center;
      width: 100%;
    }

    #resultScore {
      font-size: 36px;
      font-weight: bold;
      color: #ffffff;
      margin-top: 20px;
    }

    .result-screen p {
      font-size: 20px;
      font-weight: bold;
      color: #f8f8f2;
    }

    #timer {
  font-size: 28px;
  color: #222; /* ููู ุบุงูู ุนุดุงู ูุธูุฑ ููู ุงูุฎูููุฉ ุงูุจูุถุงุก */
  font-weight: bold;
  background: rgba(255, 215, 0, 0.2); /* ุฎูููุฉ ุดูุงูุฉ ุฐูุจูุฉ ุฎูููุฉ */
  padding: 10px 20px;
  border-radius: 10px;
  width: fit-content;
  margin: 20px auto;
  position: relative;
  z-index: 2;
  box-shadow: 0 0 10px rgba(0,0,0,0.1);
}


    .author {
      font-size: 30px;
      color: #eb2d0b;
      text-align: center;
      font-weight: bold;
      margin-bottom: 15px;
    }

    label {
      font-size: 22px;
      padding: 10px;
      display: block;
    }

    input[type="radio"] {
      transform: scale(1.5);
      margin-right: 10px;
    }

    #passage { font-size: 16px; font-weight: bold; }

    #startScreen p {
      font-size: 22px;
      font-weight: bold;
    }

    #startScreen input {
      font-size: 20px;
      font-weight: bold;
      padding: 8px;
    }

    #startScreen h1 {
      font-size: 40px;
      font-weight: bold;
      color: #ffd700;
      text-align: center;
      margin-bottom: 20px;
    }

    /* ุดุงุดุฉ ุงูุฃุณุฆูุฉ ุงูุจูุถุงุก */
    #quizContainer {
      display: none;
      position: relative;
      background: #ffffff;
      color: #000;
      border-radius: 25px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.2);
      padding: 40px;
      max-width: 1000px;
      text-align: left;
      overflow: hidden;
    }

    

    /* ุงูููุฌู ุงูุดูุงู ูู ุงูููุชุตู */
    #quizContainer::before {
      content: "";
      position: absolute;
      inset: 0;
      background: url('ilc.jpg') center center no-repeat;
      background-size: 60%;
      opacity: 0.2;
      z-index: 0;
    }

    #quizContainer > * { position: relative; z-index: 1; }

    @keyframes fall {
      to { transform: translateY(110vh); opacity: 0.5; }
    }

    
    @keyframes fadeIn {
  from { opacity:0; transform:translate(-50%, -60%); }
  to   { opacity:1; transform:translate(-50%, -50%); }
}



  </style>
</head>

<body>

  <div id="errorBox" style="
  display:none;
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  background:#cc0000;
  color:white;
  padding:20px 25px;
  border-radius:12px;
  font-size:20px;
  font-weight:700;
  text-align:center;
  z-index:9999;
  width: 80%;
  max-width: 380px;
  box-shadow:0 0 15px rgba(0,0,0,0.4);
  animation: fadeIn 0.3s ease;
"></div>





<!-- ุฑุณุงูุฉ ุงูุชูุฑุงุฑ -->
<div id="duplicateMessage" style="display:none !important; position:fixed; top:20px; left:50%; transform:translateX(-50%);
    background-color:#ff4d4f; color:white; padding:15px 25px; border-radius:10px; box-shadow:0 4px 8px rgba(0,0,0,0.2);
    font-family:Arial, sans-serif; z-index:9999; font-size:16px; display:flex; align-items:center; gap:10px;">
    <span id="duplicateIcon" style="font-size:20px;">โ</span>
    <span id="duplicateText">ุชู ุงูุชุณุฌูู ูุณุจููุง</span>
</div>



 <!-- ุดุงุดุฉ ุงูุจุฏุงูุฉ -->
<div class="container" id="startScreen" style="
max-width: 700px; 
margin: 60px auto; 
padding: 40px; 
background: #ffffff; 
border-radius: 25px; 
box-shadow: 0 10px 30px rgba(0,0,0,0.2); 
text-align: center; 
font-family: 'Trebuchet MS', sans-serif;
position: relative;
overflow: hidden;
">


<!-- ุงูุนูุงูุฉ ุงููุงุฆูุฉ ุฎูู ุงููุต -->
<img src="ilc.jpg" alt="ILC Logo" style="
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 600px;       /* ุญุฌู ุงูุนูุงูุฉ ุงููุงุฆูุฉ */
  opacity: 0.1;       /* ุงูุดูุงููุฉ */
  pointer-events: none;
  user-select: none;
  z-index: 0; /* ุฎูู ุงููุตูุต ููู ููู ุงูุฎูููุฉ */
">

<h1 style="color:#0056b3; font-size:35px; margin-bottom: 20px;">
  ๐ Drainage Training Center - Tanta   ๐
</h1>


<!-- Course Name (ูู ุงูููุชุตู ูุนูู ุณุทุฑ ูุงุญุฏ) -->
<div style="
  display: flex;
  justify-content: left;
  align-items: center;
  gap: 15px;
  margin: 20px 0;
">
  <label for="courseName" style="
    font-size: 22px;
    font-weight: bold;
    color:#0056b3;
    white-space: nowrap;
  ">
    ๐ Course Name:
  </label>

  <input type="text" id="courseName" value="(ุชุนุงูุฏุงุช)" readonly 
    style="
      font-size: 25px;
      padding:12px;
      width:60%;
      border:none;
      border-radius:10px;
      background:#f0f0f0;
      text-align:center;
      color:#000;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    ">
</div>


<!-- Enter Your Name -->
<p style="font-size: 20px;">
  <span style="color: #0056b3; font-weight: bold;">
    ๐ค Enter Your Name:
  </span>
  <input type="text" id="traineeName" placeholder="Type your name..." 
    style="font-size:18px; padding:12px; width:60%; border:1px solid #ccc; border-radius:8px; text-align:center; color:#000;">
</p>

<!-- Enter Your Phone Number -->
<p style="font-size: 20px;">
  <span style="color: #0056b3; font-weight: bold;">
    ๐ฑ Enter Your Phone Number:
  </span>
  <input type="text" id="traineePhone" placeholder="Type your phone number..." 
    style="font-size:18px; padding:12px; width:60%; border:1px solid #ccc; border-radius:8px; text-align:center; color:#000;">
</p>

<!-- Enter Trainee Code -->
<p style="font-size: 20px;">
  <span style="color: #0056b3; font-weight: bold;">
    ๐งพ Enter Your Code:
  </span>
  <input type="text" id="traineeCode" placeholder="Enter your code..." 
    style="font-size:18px; padding:12px; width:60%; border:1px solid #ccc; border-radius:8px; text-align:center; color:#000;">
</p>

<!-- Enter Password -->
<p style="font-size: 20px;">
  <span style="color: #0056b3; font-weight: bold;">
    ๐ Enter Password:
  </span>
  <input type="password" id="password" placeholder="Enter password..." 
    style="font-size:18px; padding:12px; width:60%; border:1px solid #ccc; border-radius:8px; text-align:center; color:#000;">
</p>

<!-- ุฒุฑ Start Quiz -->
<div style="text-align:center; margin-top: 15px;">

  <!-- ุฒุฑ Start Quiz -->
  <button id="startBtn" onclick="startQuiz(event)" style="
    font-size: 22px; 
    padding: 15px 50px; 
    border:none; 
    border-radius:12px; 
    background: linear-gradient(270deg, #ff0055, #ff5500, #ff00ff, #007bff, #00d4ff);
    background-size: 1000% 1000%;
    color:white; 
    cursor:pointer; 
    box-shadow:0 8px 20px rgba(0,0,0,0.3);
    display: inline-flex;
    align-items: center;
    justify-content: center;
    animation: gradientMove 4s ease infinite, glowPulse 2s infinite;
    transition: transform 0.2s;
  " onmouseover="this.style.transform='scale(1.1)'" 
     onmouseout="this.style.transform='scale(1)'">
    <span class="emoji" style="display:inline-block; margin-right:10px; animation: bounce 1s infinite;">๐</span>
    Start Quiz
  </button>

  <!-- ูุต Admin Control ุชุญุช ุงูุฒุฑ -->
<div id="adminText" onclick="toggleAdmin()" style="
    font-size: 16px;
    color: rgba(0,0,0,0.4); /* ุฎููู ูููุณุชุฎุฏู ุงูุนุงุฏู */
    font-weight: bold;
    cursor: pointer;
    user-select: none;
    margin-top: 20px; /* ุฒุฏูุง ุงููุณุงูุฉ ูู 8px ุฅูู 20px */
">
    ๐ Admin Control
</div>


</div>

<!-- ููุฏุงู ุจุงุณูุฑุฏ ุงูุงุฏูู -->
<div id="adminModal" style="
  display:none;
  position:fixed;
  top:0; left:0;
  width:100%; height:100%;
  background: rgba(0,0,0,0.6);
  justify-content:center;
  align-items:center;
  z-index:1000;
">
  <div style="
    background: linear-gradient(135deg,#ff0055,#007bff,#00d4ff);
    padding:30px; border-radius:20px;
    box-shadow:0 0 20px rgba(0,0,0,0.5);
    text-align:center;
    color:white;
    min-width:300px;
  ">
    <h2 style="margin-bottom:20px;">๐ Admin Password</h2>
    <input id="adminPwdInput" type="password" placeholder="Enter password" style="
      font-size:18px;
      padding:10px;
      width:80%;
      border-radius:10px;
      border:none;
      text-align:center;
      margin-bottom:20px;
    ">
    <br>
    <button onclick="submitAdminPwd()" style="
      font-size:16px;
      padding:10px 25px;
      border:none;
      border-radius:10px;
      background:#ff0a54;
      color:white;
      cursor:pointer;
      font-weight:bold;
      transition:0.3s;
    " onmouseover="this.style.background='#ff3366'" onmouseout="this.style.background='#ff0a54'">
      Submit
    </button>
    <br><br>
    <span id="adminMsg" style="font-size:14px;"></span>
  </div>
</div>

<script>
let startBtn = document.getElementById("startBtn");
let adminText = document.getElementById("adminText");
let adminModal = document.getElementById("adminModal");
let adminMsg = document.getElementById("adminMsg");
let adminPwdInput = document.getElementById("adminPwdInput");

const adminPassword = "Mahmoud#Osama";
let quizDisabled = false;

function toggleAdmin() {
  // ูุชุญ ุงูููุฏุงู ูุงุฏุฎุงู ุงูุจุงุณูุฑุฏ ููุท ุนูุฏ ุงูุถุบุท
  adminPwdInput.value = "";
  adminMsg.innerHTML = "";
  adminModal.style.display = "flex";  // ูุธูุฑ ุงูููุฏุงู
  adminPwdInput.focus();
}

function submitAdminPwd() {
  const pwd = adminPwdInput.value.trim();

  if (!pwd) {
    adminMsg.innerHTML = "โ ูู ูุถูู ุฃุฏุฎู ุงูุจุงุณูุฑุฏ!";
    adminMsg.style.color = "#ff3333";
    adminPwdInput.focus();
    return;
  }

  if (pwd !== adminPassword) {
    adminMsg.innerHTML = "โ ุจุงุณูุฑุฏ ุงูุฃุฏูู ุบูุฑ ุตุญูุญ!";
    adminMsg.style.color = "#ff3333";
    adminPwdInput.value = "";
    adminPwdInput.focus();
    return;
  }

  // ุชุจุฏูู ุญุงูุฉ ุงูุชุทุจูู
  quizDisabled = !quizDisabled;

  const status = quizDisabled ? 1 : 0;

  if (quizDisabled) {
    startBtn.disabled = true;
    startBtn.innerText = "Stopped...";
    adminText.innerText = "โ Quiz Disabled by Admin";
    adminMsg.innerHTML = "โ๏ธ Quiz has been disabled!";
    adminMsg.style.color = "#ffff66";
  } else {
    startBtn.disabled = false;
    startBtn.innerText = "Start Quiz";
    adminText.innerText = "๐ Admin Control";
    adminMsg.innerHTML = "โ Quiz has been enabled!";
    adminMsg.style.color = "#66ff66";
  }

  // ุฅุฑุณุงู ุงูุญุงูุฉ ุจุงุณุชุฎุฏุงู ููุณ ุทุฑููุฉ sendDataToGoogleSheet
  const formData = new URLSearchParams();
  formData.append("course", "AdminControl"); // ูุชูููุฒ ุงูุณุทุฑ ุนู ุจูุงูุงุช ุงููููุฒ
  formData.append("name", status);           // 1 ุฃู 0
  formData.append("phone", "");
  formData.append("date", new Date().toISOString());
  formData.append("startTime", "");
  formData.append("timeTaken", "");
  formData.append("score", "");

  fetch("https://script.google.com/macros/s/AKfycbw9uYQeLP2gC-x21seAYkKmbruvkaghYqUzm25dg4EbHlsBUs4ZSq8GRIV68zD9vO4WXw/exec", {
    method: "POST",
    headers: { "Content-Type": "application/x-www-form-urlencoded" },
    body: formData.toString()
  })
  .then(response => response.text())
  .then(responseText => {
    console.log("โ ุชู ุฅุฑุณุงู ุญุงูุฉ ุงูุฃุฏูู ุฅูู Google Sheet:", responseText);
  })
  .catch(error => {
    console.error("โ ุฎุทุฃ ูู ุฅุฑุณุงู ุญุงูุฉ ุงูุฃุฏูู ุฅูู Google Sheet:", error);
  });

  // ุฅุบูุงู ุงูููุฏุงู ุจุนุฏ ุซุงููุฉ
  setTimeout(() => {
    adminModal.style.display = "none";
  }, 1000);
}


</script>


<p style="margin-top: 40px; font-size: 18px; color: gray;">
  โ๏ธ Edited by: Ahmed Amer
</p>

<!-- ุฅูููุฌู ุงููุทุฑ -->
<div id="emojiRain" style="
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  pointer-events: none;
  font-size: 2rem;
"></div>
</div>

<style>
@keyframes gradientMove {
0% { background-position: 0% 50%; }
50% { background-position: 100% 50%; }
100% { background-position: 0% 50%; }
}

@keyframes glowPulse {
0%, 100% { box-shadow: 0 8px 20px rgba(255, 0, 85, 0.6), 0 0 10px rgba(255, 255, 255, 0.2); }
50% { box-shadow: 0 8px 25px rgba(255, 0, 85, 0.9), 0 0 20px rgba(255, 255, 255, 0.4); }
}

@keyframes bounce {
0%, 100% { transform: translateY(0); }
50% { transform: translateY(-8px); }
}
</style>

<script>
const emojis = ["๐","โ๏ธ","๐","๐","โณ","๐ฏ","๐","๐","๐จโ๐"];
const container = document.getElementById("emojiRain");
let rainInterval;

function createEmoji() {
const emoji = document.createElement("div");
emoji.innerText = emojis[Math.floor(Math.random() * emojis.length)];
emoji.style.position = "absolute";
emoji.style.left = Math.random() * 100 + "vw";
emoji.style.top = "-50px";
emoji.style.fontSize = "28px";
emoji.style.animation = `fall ${6 + Math.random() * 3}s linear`;
container.appendChild(emoji);
setTimeout(() => emoji.remove(), 2000);
}

function startEmojiRain() {
rainInterval = setInterval(createEmoji, 500);
}

function stopEmojiRain() {
clearInterval(rainInterval);
container.innerHTML = "";
}

startEmojiRain();

function startQuiz() {
document.getElementById("startScreen").style.display = "none";
stopEmojiRain();
// ููุง ุถุน ุฃู ููุฏ ูุชุธูุฑ ุดุงุดุฉ ุงููููุฒ
}
</script>


  <!-- ุดุงุดุฉ ุงูุฃุณุฆูุฉ -->
  <div class="container" id="quizContainer">
    <h2 id="quizTitle">Placement Test</h2>
    <p class="author"> ๐ The International British Institute  ๐ 
    <p>Date: <span id="date"></span></p>
     <!-- Emoji Sticky Animation -->
 <div id="emoji-character" style="
    position: sticky;
    top: 10px;
    float: right;
    margin-left: auto;
    display: block;
    z-index: 10;
">
  <img src="ilc.jpg" alt="ILC Logo" style="
      width: 180px;
      height: auto;
      border-radius: 12px;
      box-shadow: 0 0 12px rgba(0,0,0,0.3);
  ">
</div>

    <p id="timer"> ----- </p>
    <div id="passage">
      <h3>Read the following passage carefully and answer the following questions:</h3>
      <p style="font-size: 22px;"></p>
    </div>
    <div id="quiz"></div>

  
  </div>

<!-- ุดุงุดุฉ ุงููุชูุฌุฉ -->
<div class="result-screen" id="resultScreen" style="
display:none;
background: #0056b3; /* ุฎูููุฉ ููุฑูุงู ุฃุฒุฑู ุซุงุจุช */
padding: 40px;
border-radius: 25px;
text-align: center;
color: #fff;
position: relative;
font-family: 'Arial', sans-serif;
max-width: 800px;
margin: 40px auto;
box-shadow: 0 0 20px rgba(0,0,0,0.4);
border: 3px solid #ffd700; /* ุจูุฑุฏุฑ ุฐูุจู ุฃููู */
overflow: hidden;
">

<h1 id="resultTitle" style="font-size: 46px; margin-bottom: 25px; font-weight:bold;"></h1>

<p style="font-size: 30px; margin: 12px 0;">
  ๐ <strong>Course Name:</strong> <span id="resultCourse"></span>
</p>
<p style="font-size: 28px; margin: 12px 0;">
  ๐ค <strong>Name:</strong> <span id="resultName"></span>
</p>
<p style="font-size: 28px; margin: 12px 0;">
  ๐ฑ <strong>Phone Number:</strong> <span id="resultPhone"></span>
</p>

<p style="font-size: 28px; margin: 12px 0;">
  ๐ <strong>Code:</strong> <span id="resultCode"></span>
</p>


<p style="font-size: 28px; margin: 12px 0;">
  ๐ <strong>Test Date:</strong> <span id="resultDate"></span>
</p>
<p style="font-size: 28px; margin: 12px 0;">
  โฐ <strong>Start Time:</strong> <span id="resultStartTime"></span>
</p>
<p style="font-size: 28px; margin: 12px 0;">
  โฑ๏ธ <strong>Time Taken:</strong> <span id="resultTime"></span>
</p>

<!-- Score & Rating (ุงูุณููุฑ ูุฎูู ููู ููุฌูุฏ ุนุดุงู ุงูููุฏ ูุง ููุนุด) -->
<p style="font-size: 32px; font-weight: bold; color: #ffd700; margin-top: 25px;">
  <span id="resultScore" style="display:none;"></span>
  ๐ Grade: <span id="resultRating"></span>
</p>




<a href="https://etiqotwf.github.io/liveServer1/ilc/DtcEstbian" target="_blank" style="
  display:block;
  margin-top: 30px;
  font-size:28px;
  font-weight:bold;
  color:#fff;
  text-decoration: underline;
">
  ๐ Click here to share dtcEstbian
</a>

<!-- ุงูุฃูุนุงุจ ุงููุงุฑูุฉ -->
<div id="fireworks" style="
  position:absolute;
  top:0;
  left:0;
  width:100%;
  height:100%;
  pointer-events:none;
"></div>
</div>

<style>
/* Score ู Rating ุฃููุงู ุฐูุจูุฉ ุซุงุจุชุฉ */
#resultScore, #resultRating {
  background: none !important;
  -webkit-background-clip: none !important;
  -webkit-text-fill-color: #ffd700; /* ุฐูุจู */
  animation: none !important;
}

/* ุชุญุณูู ุงูุฎุทูุท ุฏุงุฎู ุงููุชูุฌุฉ */
.result-screen p {
  font-family: 'Arial', sans-serif;
  line-height: 1.6;
}

/* ุชุญุณูู ุงูุฑุงุจุท */
.result-screen a:hover {
  color: #ffd700;
}

/* ุญุฑูุฉ ุงูุฃูุนุงุจ ุงููุงุฑูุฉ */
@keyframes fireworkFall {
  0% { transform: translateY(0) scale(1); opacity:1; }
  100% { transform: translateY(-100px) scale(0.5); opacity:0; }
}
</style>

<script>
// ูุชุบูุฑุงุช ูุชุฎุฒูู ุจูุงูุงุช ุงููุชุฏุฑุจ
let traineeData = {
  course: "ุบูุฑ ูุญุฏุฏ",
  name: "ุบูุฑ ูุญุฏุฏ",
  phone: "ุบูุฑ ูุญุฏุฏ"
};

// ุฏุงูุฉ ูุชุญุฏูุซ ุจูุงูุงุช ุงููุชุฏุฑุจ
function setTraineeData(course, name, phone) {
  traineeData.course = course || "ุบูุฑ ูุญุฏุฏ";
  traineeData.name = name || "ุบูุฑ ูุญุฏุฏ";
  traineeData.phone = phone || "ุบูุฑ ูุญุฏุฏ";
}

// ุฏุงูุฉ ูุชุญุฏูุฏ ุงูุชูุฏูุฑ ุจูุงุกู ุนูู ุงูุฏุฑุฌุฉ
function calculateRating(score, maxScore) {
  if (score === undefined || maxScore === undefined) return "ุบูุฑ ูุญุฏุฏ โ";

  // ุงูุชูุฏูุฑุงุช ุญุณุจ ุทูุจ ุงููุฏุฑุณ
  if (score >= 0 && score < 5) return "Good ๐";
  else if (score >= 5 && score < 15) return "Very Good ๐";
  else if (score >= 15 && score <= maxScore) return "Excellent ๐";
  else return "ุบูุฑ ูุญุฏุฏ โ";
}


// ุฏุงูุฉ ูุฅุธูุงุฑ ุงูุชูุฏูุฑ ูุจุงุดุฑุฉ ูู ุงูุฑูู
function displayRatingFromNumber(score, maxScore) {
  const ratingEl = document.getElementById("resultRating");
  if (!ratingEl) return;
  const rating = calculateRating(score, maxScore);
  ratingEl.innerText = rating;
}

// ุฏุงูุฉ ุจุณูุทุฉ ููุฃูุนุงุจ ุงููุงุฑูุฉ
function launchFireworks() {
  const fireworks = document.getElementById('fireworks');
  for(let i=0;i<50;i++){
    const emoji = document.createElement('div');
    emoji.innerText = "๐";
    emoji.style.position = "absolute";
    emoji.style.left = Math.random()*100 + "%";
    emoji.style.top = Math.random()*100 + "%";
    emoji.style.fontSize = (20 + Math.random()*30) + "px";
    emoji.style.animation = `fireworkFall ${2+Math.random()*2}s linear forwards`;
    fireworks.appendChild(emoji);
    setTimeout(()=> emoji.remove(), 4000);
  }
}


</script>



<script>
    // ุนูุฏ ุงูุถุบุท ุนูู ุฃู ููุงู ูู ุงูุตูุญุฉุ ุฃุฏุฎู ูุถุน ููุก ุงูุดุงุดุฉ
    document.addEventListener("click", () => {
      const elem = document.documentElement; // ุฃู document.getElementById("myForm")
      if (document.fullscreenElement) return; // ูุง ุชูุนู ุดูุก ุฅุฐุง ููุง ุจุงููุนู ูู ููุก ุงูุดุงุดุฉ

      if (elem.requestFullscreen) {
        elem.requestFullscreen();
      } else if (elem.webkitRequestFullscreen) { /* Safari */
        elem.webkitRequestFullscreen();
      } else if (elem.msRequestFullscreen) { /* IE11 */
        elem.msRequestFullscreen();
      }
    });
  </script>

    
   <script>
       document.getElementById("date").innerText = new Date().toLocaleDateString("en-US");
    
 const trueFalseQuestions = [
  {
    passage: "ุณ: ุถุน ุนูุงูุฉ ุตุญ ุฃู ุฎุทุฃ ุนูู ูุง ููู",
    q: "ูุฌูุฒ ููุฌูุฉ ุงูุฅุฏุงุฑูุฉ ุงุฌุฑุงุก ุชุนุฏูู ุนูู ูุฑุงุณุฉ ุงูุดุฑูุท ุจุนุฏ ุงูุทุฑุญ ููุจู ููุนุฏ ุฌูุณุฉ ูุชุญ ุงููุธุงุฑูู ุงููููุฉ",
    a: "True",
    options: ["True", "False"]
  },
  {
    passage: "ุณ: ุถุน ุนูุงูุฉ ุตุญ ุฃู ุฎุทุฃ ุนูู ูุง ููู",
    q: "ูุฌูุฒ ุณุฏุงุฏ ุงูุชุงููู ุงููุคูุช ูู ุฎูุงู ููุธููุฉ ุงูุฏูุน ูุงูุชุญุตูู ุงูุงููุชุฑููู",
    a: "True",
    options: ["True", "False"]
  },
  {
    passage: "ุณ: ุถุน ุนูุงูุฉ ุตุญ ุฃู ุฎุทุฃ ุนูู ูุง ููู",
    q: "ุฅุฐุง ุงูุณุญุจ ููุฏู ุงูุนุทุงุก ุจุนุฏ ุชูุฏููู ููุจู ุฌูุณุฉ ูุชุญ ุงููุธุงุฑูู ุงููููุฉ ูุฑุฏ ุงููู ุงูุชุงููู ุงููุคูุช",
    a: "False",
    options: ["True", "False"]
  },
  {
    passage: "ุณ: ุถุน ุนูุงูุฉ ุตุญ ุฃู ุฎุทุฃ ุนูู ูุง ููู",
    q: "ูุฌูุฒ ููุฌูุฉ ุงูุฅุฏุงุฑูุฉ ุงูุชุนุงูุฏ ูุน ุงูุนุงูููู ุจูุง ูุดุฑุงุก ูุชุจ ูู ุชุฃููููู ุงู ุงุนูุงู ูููุฉ ุงู ูุชูููููู ุจุฃุนูุงู ูููุฉ ุฐุงุช ุตูุฉ ุจุงูุฃุนูุงู ุงููุตูุญูุฉ",
    a: "True",
    options: ["True", "False"]
  },
  {
    passage: "ุณ: ุถุน ุนูุงูุฉ ุตุญ ุฃู ุฎุทุฃ ุนูู ูุง ููู",
    q: "ูู ุญุงูุฉ ุชูุฏูู ุนุทุงุก ูู ุดุฑูุฉ ูู ุงูุฎุงุฑุฌ ููุชุงุจุฉ ุงูุฃุณุนุงุฑ ุจุงูุนููุฉ ุงูุฃุฌูุจูุฉ ูุชู ูุนุงุฏูุชูุง ุจุงูุฌููุฉ ุงููุตุฑู ูููุง ูุณุนุฑ ุงููุนูู ูู ุงูุจูู ุงููุฑูุฒู ููุช ูุชุญ ุงููุธุงุฑูู ุงููุงููุฉ",
    a: "False",
    options: ["True", "False"]
  },
  {
    passage: "ุณ: ุถุน ุนูุงูุฉ ุตุญ ุฃู ุฎุทุฃ ุนูู ูุง ููู",
    q: "ุฅุฐุง ุชุนุฐุฑ ุงูุชูุงุก ุฅุฌุฑุงุกุงุช ุงูุจุช ูุงูุฅุฎุทุงุฑ ุจุงูุชุฑุณูุฉ ูุจู ุงูุชูุงุก ูุฏุฉ ุณุฑูุงู ูุฐู ุงูุนุทุงุกุงุชุ ููุงููุช ุงูุณูุทุฉ ุงููุฎุชุตุฉ ุนูู ูุฏ ูุฏุฉ ุณุฑูุงู ุงูุนุทุงุกุงุชุ ูุฑูุถ ุตุงุญุจ ุงูุนุทุงุก ูุฏ ูุฏุฉ ุณุฑูุงู ุนุทุงุฆู ูุงูุชุงููู ุงููุคูุช ูุชู ุงุณุชุจุนุงุฏู ูุฑุฏ ุงูุชุงููู ุงููู",
    a: "False",
    options: ["True", "False"]
  },
  {
    passage: "ุณ: ุถุน ุนูุงูุฉ ุตุญ ุฃู ุฎุทุฃ ุนูู ูุง ููู",
    q: "ุงูุชุนุงูุฏ ุนูู ุดุฑุงุก ุงู ุงุณุชุฆุฌุงุฑ ุงูุนูุงุฑุงุช ูุฌุจ ุงู ูุดุชุฑู ูู ูุฌูุฉ ุงูุจุช ููุซู ููุฒุงุฑุฉ ุงูุฅุณูุงู",
    a: "True",
    options: ["True", "False"]
  },
  {
    passage: "ุณ: ุถุน ุนูุงูุฉ ุตุญ ุฃู ุฎุทุฃ ุนูู ูุง ููู",
    q: "ุชุชููู ุฅุฌุฑุงุกุงุช ุงูุชุนุงูุฏ ูู ุงูููุงูุตุฉ ุงูุชู ูุง ุชุฌุงูุฒ ูููุชูุง ุซูุงุซูุงุฆุฉ ุฃูู ุฌููู ูุฌูุฉูุชุญ ูุธุงุฑูู ููุฌูุฉ ุจุช",
    a: "False",
    options: ["True", "False"]
  },
  {
    passage: "ุณ: ุถุน ุนูุงูุฉ ุตุญ ุฃู ุฎุทุฃ ุนูู ูุง ููู",
    q: "ูุฌูุฒ ูู ุญุงูุฉ ูุง ุงุฐ ูุงู ุงููุชูุฏู ุดุฑููุง ูุน ุงูุบูุฑ ุจุญุตุฉ ูุง ุชุณูุญ ูู ุจุงูุชุฃุซูุฑ ูู ุงุชุฎุงุฐ ูุฑุงุฑ ุฐู ุตูุฉ ุจุงูุนุทุงุกุ ุงู ูุชูุฏู ุจุนุทุงุก ุงุฎุฑ",
    a: "True",
    options: ["True", "False"]
  },
  {
    passage: "ุณ: ุถุน ุนูุงูุฉ ุตุญ ุฃู ุฎุทุฃ ุนูู ูุง ููู",
    q: "ุชุณุชุจุนุฏ ุงูุนุทุงุกุงุช ุงูุชู ูู ุชุถูู ูุนุงููุงุช ุชุบูุฑ ุงูุฃุณุนุงุฑ ูู ููุงููุงุช ุงูุฃุนูุงู ุทุจูุง ูุดุฑูุท ุงูุทุฑุญ",
    a: "True",
    options: ["True", "False"]
  },
  {
    passage: "ุณ: ุถุน ุนูุงูุฉ ุตุญ ุฃู ุฎุทุฃ ุนูู ูุง ููู",
    q: "ูู ุญุงูุฉ ุนุฏู ุงุณุชุฌุงุจุฉ ุตุงุญุจ ุงูุนุทุงุก ูุทูุจ ุงุณุชููุงุก ุงูุจูุงูุงุช ุฃู ุงููุณุชูุฏุงุช ูุงุณุชูุถุงุญ ุงูุฃููุฑ ุงููููุฉ ุจุนุทุงุฆู ุฎูุงู ุงููุฏุฉ ุงููุญุฏุฏุฉ ูู ุงููุฌูุฉ ุงูุจุช ุงูููู ูุงูููุถุญุฉ ุจุทูุจูุง ุฅูููุ ูุชู ุงุณุชุจุนุงุฏ ุนุทุงุฆู ุจุงุนุชุจุงุฑู ุบูุฑ ูุงุถุญ ุฃู ุบูุฑ ูุงุจู ููููุงุฑูุฉ ูุน ุงูุนุทุงุกุงุช ุงูุฃุฎุฑู",
    a: "True",
    options: ["True", "False"]
  },
  {
    passage: "ุณ: ุถุน ุนูุงูุฉ ุตุญ ุฃู ุฎุทุฃ ุนูู ูุง ููู",
    q: "ุชูุฏูู ุฃูุซุฑ ูู ูุณุฎุฉ ููุนุทุงุก ุทุจูุง ูููุฑุงุณุฉ ูุชุจูู ูุฌูุฏ ุงุฎุชูุงู ูู ุงูุณุนุฑ ุจูู ุงููุณุฎ ุงูููุฏูุฉ ูุคุฎุฐ ุจุงูุณุนุฑ ุงูุฃูู",
    a: "False",
    options: ["True", "False"]
  },
  {
    passage: "ุณ: ุถุน ุนูุงูุฉ ุตุญ ุฃู ุฎุทุฃ ุนูู ูุง ููู",
    q: "ุงูุนุทุงุก ุงููุจูู ุนูู ุฎูุถ ูุณุจุฉ ูุฆููุฉ ุนู ูููุฉ ุฃูู ุนุทุงุก ููุฏู ูู ุงูุนูููุฉ ุนุทุงุก ููุจูู",
    a: "False",
    options: ["True", "False"]
  },
  {
    passage: "ุณ: ุถุน ุนูุงูุฉ ุตุญ ุฃู ุฎุทุฃ ุนูู ูุง ููู",
    q: "ุชูุบู ุงูููุงูุตุฉ ุฃู ุงูููุงุฑุณุฉ ุจุฌููุน ุฃููุงุนููุง ูุจู ุงูุจุช ูููุง ุจูุฑุงุฑ ูุณุจุจ ูู ุงูุณูุทุฉ ุงููุฎุชุตุฉ ุฅุฐุง ุชุจูู ููุฌูุฉ ุชูุถูู ุงูููุชุฌ ุงูุตูุงุนู ุงููุตุฑู ุฃู ุดุฑูุท ุทุฑุญ ุงูุนููุฏ ุงูููุตูุต ุนูููุง ูู ุงูููุฑุฉ ุงูุฃููู ูู ุงููุงุฏุฉ (11) ุชุฎุงูู ุฃุญูุงู ูุฐุง ุงููุงููู",
    a: "True",
    options: ["True", "False"]
  },
  {
    passage: "ุณ: ุถุน ุนูุงูุฉ ุตุญ ุฃู ุฎุทุฃ ุนูู ูุง ููู",
    q: "ุฅุฐุง ุงุฎุชูู ุฃุนุถุงุก ูุฌูุฉ ุงูุจุช ูู ุงูุฑุฃู ุญูู ูุจูู ุฃู ุฑูุถ ุฃู ูู ุงูุนุทุงุกุงุช ุ ูุฑุฌุญ ุฑุฃู ุงูุฃุบูุจูุฉ",
    a: "False",
    options: ["True", "False"]
  },
  {
    passage: "ุณ: ุถุน ุนูุงูุฉ ุตุญ ุฃู ุฎุทุฃ ุนูู ูุง ููู",
    q: "ูุง ูุญุตู ูู ุตุงุญุจ ุงูุนุทุงุก ุงููุงุฆุฒ ุงูุชุฃููู ุงูููุงุฆู ุฅุฐุง ูุฑุฏ ุฌููุน ุงูุฃุตูุงู ุงูุชู ุฑุณุง ุนููู ุชูุฑูุฏูุง ููุจูุชูุง ุงูุฌูุฉ ุงูุฅุฏุงุฑูุฉ ุจุตูุฉ ููุงุฆูุฉ ุฎูุงู ุงููููุฉ ุงููุญุฏุฏุฉ ูุฃุฏุงุก ุงูุชุฃููู ุงูููุงุฆู ูุฐูู ุฅุฐุง ูู ููู ููุฐู ุงูุฃุตูุงู ูุฏุฉ ุถูุงู",
    a: "True",
    options: ["True", "False"]
  },
  {
    passage: "ุณ: ุถุน ุนูุงูุฉ ุตุญ ุฃู ุฎุทุฃ ุนูู ูุง ููู",
    q: "ูุฌุจ ุนูู ุฅุฏุงุฑุฉ ุงูุชุนุงูุฏุงุช ุฅุจูุงุบ ูุตูุญุฉ ุงูุถุฑุงุฆุจ ุงููุตุฑูุฉ ุจูููุฉ ุงูุนูุฏ ููุฏุฉ ุชูููุฐู",
    a: "True",
    options: ["True", "False"]
  },
  {
    passage: "ุณ: ุถุน ุนูุงูุฉ ุตุญ ุฃู ุฎุทุฃ ุนูู ูุง ููู",
    q: "ูุง ูุชู ุตุฑู ูุฑูู ุงูุฃุณุนุงุฑ ููุง ูุชู ุดุฑุงุคู ูู ูููุฉ ุงูุฏูุนุฉ ุงูููุฏูุฉ ูู ุงูุนููุฏ ุงูุชู ุชุชุทูุจ ุฐูู",
    a: "True",
    options: ["True", "False"]
  },
  {
    passage: "ุณ: ุถุน ุนูุงูุฉ ุตุญ ุฃู ุฎุทุฃ ุนูู ูุง ููู",
    q: "ูู ุญุงูุฉ ูุณุฎ ุงูุชุนุงูุฏ ูุญู ุงูุฌูุฉ ุงูุฅุฏุงุฑูุฉ ุงู ุชุฃุฎุฐ ุงููููุงุช ุงูุชู ุชูุฒู ูุฅุชูุงู ุงูุฃุนูุงู ุดุฑูุทุฉ ุฃู ุชููู ุตุงูุญุฉ ููุงุณุชุนูุงู",
    a: "True",
    options: ["True", "False"]
  },
  {
    passage: "ุณ: ุถุน ุนูุงูุฉ ุตุญ ุฃู ุฎุทุฃ ุนูู ูุง ููู",
    q: "ุชุนูู ุงููุดุฑูุนุงุช ุงููุชูุณุทุฉ ููุชูุงููุฉ ุงูุตุบุฑ ูู ุฃุฏุงุก ุงูุชุงููู ุงููุคูุช ูู ุงูููุงูุตุฉ ุงููุญููุฉ ุงูุชู ูุง ุชุฒูุฏ ูููุชูุง ุนูู ูููููู ุฌููู ูู ุญุงูุฉ ูุตุฑ ุงูุงุดุชุฑุงู ูููุง ุนูููู",
    a: "True",
    options: ["True", "False"]
  },
  {
    passage: "ุณ: ุถุน ุนูุงูุฉ ุตุญ ุฃู ุฎุทุฃ ุนูู ูุง ููู",
    q: "ูุฌูุฒ ูุฃู ูู ูุฐู ุงูุณูุทุงุช ุงูุชูููุถ ูู ุงูุงุฎุชุตุงุตุงุช ุงูููููุญุฉ ููุง ููุชุนุงูุฏ ุจุทุฑูู ุงูุงุชูุงู ุงููุจุงุดุฑ",
    a: "False",
    options: ["True", "False"]
  },
  {
    passage: "ุณ: ุถุน ุนูุงูุฉ ุตุญ ุฃู ุฎุทุฃ ุนูู ูุง ููู",
    q: "ูุฌูุฒ ูููุชุนุงูุฏ ุฃู ูุชูุงุฒู ุนู ุงููุจุงูุบ ุงููุณุชุญูุฉ ูู ูููุง ุฃู ุจุนุถูุง ุนู ุงูุนูุฏ ูุฃุญุฏ ุงูุจููู ุฃู ุงูุดุฑูุงุช ุงููุงููุฉ ุบูุฑ ุงููุตุฑููุฉ ุงููุฑุฎุต ููุง ุจูุฒุงููุฉ ุงููุดุงุท ูู ุฌูููุฑูุฉ ูุตุฑ ุงูุนุฑุจูุฉุ ูููุชูู ูู ูุฐู ุงูุญุงูุฉ ุจุชุตุฏูู ุงูุจูู ุฃู ุงูุดุฑูุฉ",
    a: "True",
    options: ["True", "False"]
  },
  {
    passage: "ุณ: ุถุน ุนูุงูุฉ ุตุญ ุฃู ุฎุทุฃ ุนูู ูุง ููู",
    q: "ุงุญุฏ ุงูุนุทุงุก ุงุซุจุช ูู ุนุทุงุฆู ุงููุงูู ุนุจุงุฑุฉ (ุงูุจู 5%) ููุงูุช ูุฌูุฉ ุงูุจุช ุจูุฎุงุทุจุชู ูุงุณุชูุถุงุญ ูุงูุงุณุชูุณุงุฑ ุนููุง ุ ููุฏ ุงูุงุฏ ุงูู ููุตุฏ ุงูู ููุจู ุฎุตู 5% ูู ุนุทุงุฆู ุ ููุงูุช ูุฌูุฉ ุงูุจุช ุจุงุณุชุจุนุงุฏ ุงููุณุจุฉ ุนูุฏ ุชูููู ุนุทุงุฆู ูุชุฑุชูุจ ุฃููููุฉ ุงูุนุทุงุกุงุช ุุชูููู ูุชุตุฑู ูุฌูุฉ ุงูุจุช",
    a: "True",
    options: ["True", "False"]
  },
  {
    passage: "ุณ: ุถุน ุนูุงูุฉ ุตุญ ุฃู ุฎุทุฃ ุนูู ูุง ููู",
    q: "ูุชู ุงุณุชุจุนุงุฏ ุงูุนุทุงุก ุงูุฐู ูู ููุฏู ูุนู ุดูุงุฏุฉ ุงูููุฏ ุจุงุชุญุงุฏ ููุงููู ุงูุชุดููุฏ",
    a: "True",
    options: ["True", "False"]
  }
];

const questions = [
  {
    q: "ุชููู ูุฌูุฉ ุชูููู ุงูุฃุตูู ุงูุนูุงุฑูุฉ ูู ุฎูุงู ุงููููููู ุงูุนูุงุฑููู ุงูุซูุงุซุฉ ุงููุชุนุงูุฏ ูุนูู ูู ุญุงูุฉ ูุฌูุฏ ุชูุงูุช ุจูู ุงูุชูููู ุงูุฃุนูู ูุงูุงูู ูุฌุงูุฒ 20% ุจุงูุฅุฌุฑุงุก ุงูุงุชู:",
    a: "c",
    options: [
      "ุงูุงุฎุฐ ุจูุชูุณุท ุงูุชูููุงุช ุงูุซูุงุซ",
      "ุงูุงุฎุฐ ุจุงูุชูููู ุงูุฃุนูู",
      "ุชูููู ูููู ุฑุงุจุน ูุฅุนุงุฏุฉ ุงูุชูููู"
    ]
  }
];

    
        let currentTFQuestion = 0;
        let tfCorrectAnswers = 0;
        let currentQuestion = 0;
        let correctAnswers = 0;
        let timeLeft = 3600;
        let timerInterval;
        let startTime;
    
      /**
       * 
 * ุฑุงุจุท Web App (ุงุณุชุจุฏู ูู ุนูุฏู ID ูุฎุชูู)
 */


 
const CHECK_URL = "https://script.google.com/macros/s/AKfycbw9uYQeLP2gC-x21seAYkKmbruvkaghYqUzm25dg4EbHlsBUs4ZSq8GRIV68zD9vO4WXw/exec";

/**
 * ูุชุญูู ูู ุงูุชูุฑุงุฑ ุนุจุฑ doGet?action=checkDuplicate
 * ูุฑุฌุน ูุงุฆู { ok: true } ุฃู { ok: false, message: "..." }
 */


 
async function checkDuplicate(name, phone, quizName) {
  const url = `${CHECK_URL}?action=checkDuplicate&name=${encodeURIComponent(name)}&phone=${encodeURIComponent(phone)}&quizName=${encodeURIComponent(quizName)}`;
  console.log("Checking URL:", url);

  try {
    const res = await fetch(url, { method: 'GET', cache: 'no-store' });
    console.log("Fetch response:", res);

    if (!res.ok) {
      return { ok: false, message: 'ุฎุทุฃ ูู ุงูุงุชุตุงู ุจุฎุฏูุฉ ุงูุชุญูู (HTTP ' + res.status + ')' };
    }

    const data = await res.json();
    console.log("Data from server:", data);

    // ุงูุชุญูู ูู ุชูุฑุงุฑ ุงูุจูุงูุงุช ุงููุนุชุงุฏ
    if (data.status === 'duplicate') return { ok: false, message: data.message };

    // ุงูุชุญูู ูู ุขุฎุฑ ุตู ุฅุฐุง ูุงู ูุญุชูู ุนูู 1
    if (data.status === 'lastRow1') {
      return { ok: false, message: data.message };
    }

    if (data.status === 'ok') return { ok: true };

    return { ok: false, message: data.message || 'ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุงูุชุญูู ูู ุงูุชูุฑุงุฑ.' };

  } catch (err) {
    console.error("checkDuplicate error:", err);
    return { ok: false, message: 'ุฎุทุฃ ูู ุงูุงุชุตุงู. ุชุฃูุฏ ูู ุงูุฅูุชุฑูุช.' };
  }
}


// ========== ุฏุงูุฉ ุชูููุฏ ูููุฉ ุณุฑ ููููุฉ (ุซุงุจุชุฉ ุทูุงู ุงูููู) ==========
function getDailyPassword() {
  const today = new Date();
  const day = today.getDate();
  const month = today.getMonth() + 1;
  const year = today.getFullYear();

  // ุชูููุฏ ูููุฉ ููููุฉ (ูููู ุชุนุฏูู ุงูุตูุบุฉ ูู ุญุจูุช ุฃูููุง ุฃูุซุฑ)
  const seed = (day * 7 + month * 13 + year) % 10000;
  return (1000 + seed).toString(); // ูุซุงู: ุฑูู ูู 4 ุฎุงูุงุช ุซุงุจุช ุงูููู
}




// ==================== ุฌูุจ ุญุงูุฉ ุงููููุฒ ุนูุฏ ุชุญููู ุงูุตูุญุฉ ====================
async function fetchQuizStatus() {
  try {
    const res = await fetch(CHECK_URL + "?action=getQuizStatus");
    const data = await res.json();
    const quizDisabled = data.status == 1;

    const startBtn = document.getElementById("startBtn");
    const adminText = document.getElementById("adminText");
    const adminMsg = document.getElementById("adminMsg");

    if (quizDisabled) {
      startBtn.disabled = true;
      startBtn.innerText = "โ Quiz Disabled by Admin";
      adminText.innerText = "โ Quiz Disabled by Admin";
      adminMsg.innerHTML = "โ๏ธ Quiz has been disabled!";
      adminMsg.style.color = "#ffff66";
    } else {
      startBtn.disabled = false;
      startBtn.innerText = "Start Quiz";
      adminText.innerText = "๐ Admin Control";
      adminMsg.innerHTML = "โ Quiz has been enabled!";
      adminMsg.style.color = "#66ff66";
    }
  } catch (err) {
    console.error("Error fetching quiz status:", err);
  }
}

// ==================== ุฒุฑ Admin Control ====================
async function toggleQuiz() {
  const startBtn = document.getElementById("startBtn");
  const adminText = document.getElementById("adminText");
  const adminMsg = document.getElementById("adminMsg");

  let quizDisabled = startBtn.disabled; // ุงูุญุงูุฉ ุงูุญุงููุฉ
  quizDisabled = !quizDisabled; // ููุจ ุงูุญุงูุฉ

  // ุชุญุฏูุซ ุงููุงุฌูุฉ
  if(quizDisabled){
    startBtn.disabled = true;
    startBtn.innerText = "โ Quiz Disabled by Admin";
    adminText.innerText = "โ Quiz Disabled by Admin";
    adminMsg.innerHTML = "โ๏ธ Quiz has been disabled!";
    adminMsg.style.color = "#ffff66";
  } else {
    startBtn.disabled = false;
    startBtn.innerText = "Start Quiz";
    adminText.innerText = "๐ Admin Control";
    adminMsg.innerHTML = "โ Quiz has been enabled!";
    adminMsg.style.color = "#66ff66";
  }

  // ุฅุฑุณุงู ุงูุญุงูุฉ ุงูุฌุฏูุฏุฉ ููู Google Sheet
  try {
    await fetch(CHECK_URL + "?action=updateStatus", {
      method: "POST",
      headers: { "Content-Type": "application/x-www-form-urlencoded" },
      body: new URLSearchParams({ status: quizDisabled ? "1" : "0" })
    });

    // ุฅุนุงุฏุฉ ุฌูุจ ุงูุญุงูุฉ ููุชุฃููุฏ
    fetchQuizStatus();
  } catch (err) {
    console.error("Error updating quiz status:", err);
  }
}

// ==================== startQuiz ====================
async function startQuiz(event) {
  const startBtn = document.getElementById("startBtn");
  if (startBtn.disabled) {
    alert("โ๏ธ ุงููููุฒ ูุนุทู ูู ุงูุฃุฏูู ุญุงููุงู.");
    return;
  }

  // ูุฑุงุกุฉ ุงูุญููู
  let name = document.getElementById("traineeName").value.trim();
  let phone = document.getElementById("traineePhone").value.trim();
  let traineeCode = document.getElementById("traineeCode").value.trim();
  let password = document.getElementById("password").value;
  let course = document.getElementById("courseName").value.trim();
  let quizTitle = document.getElementById("quizTitle");

  // ุฅุฒุงูุฉ ุงูุตูุฑ ุงูุฃูู ูู ุฑูู ุงูุชููููู ูู ููุฌูุฏ
  if (phone.startsWith('0')) {
      phone = phone.substring(1);
  }

  // ุชุญูู ูุญูู ุณุฑูุน
  if (!name) { alert("โ ุจุฑุฌุงุก ุฅุฏุฎุงู ุงูุงุณู."); return; }
  if (!phone) { alert("โ ุจุฑุฌุงุก ุฅุฏุฎุงู ุฑูู ุงูุชููููู."); return; }
  if (!traineeCode) { alert("โ ุจุฑุฌุงุก ุฅุฏุฎุงู ุงูููุฏ ุงูุฎุงุต ุจู."); return; }

  // ุงูุชุญูู ูู ุญุงูุฉ ุชุนุทูู ุงูุจุงุณูุฑุฏ ูู ุงูุฃุฏูู
  const passwordDisabled = localStorage.getItem("passwordDisabled") === "true";

  // ุชุญูู ูู ูููุฉ ุงููุฑูุฑ ุงูููููุฉ (ูู ุงูุจุงุณูุฑุฏ ุบูุฑ ูุนุทู)
  const dailyPassword = getDailyPassword();
if (!passwordDisabled && password !== dailyPassword) {
  const errorBox = document.getElementById("errorBox");
  if (errorBox) {
    errorBox.innerHTML = "โ ูููุฉ ุงููุฑูุฑ ุบูุฑ ุตุญูุญุฉ<br>ูุฑุฌู ุงูุชูุงุตู ูุน ุงูุฅุฏุงุฑุฉ ููุญุตูู ุนูู ูููุฉ ุงููุฑูุฑ ุงูุตุญูุญ.";
    errorBox.style.display = "block";

    setTimeout(() => {
      errorBox.style.display = "none";
    }, 4000);
  } else {
    alert("โ ูููุฉ ุงููุฑูุฑ ุบูุฑ ุตุญูุญุฉ. ุชูุงุตู ูุน ุงูุฅุฏุงุฑุฉ ููุญุตูู ุนูู ูููุฉ ุงููุฑูุฑ ุงูุตุญูุญุฉ.");
  }
  return;
}


  // ุงูุญุตูู ุนูู ุงูุฒุฑ ูุชุบููุฑ ุงููุต ูุชุนุทููู
  const startButton = event && event.currentTarget ? event.currentTarget : document.querySelector('.btn');
  let prevText = startButton ? startButton.innerText : "Start Quiz";

if (startButton) {
    startButton.disabled = true;

    //  ุณุงุนุฉ ุฑูููุฉ ูุชุญุฑูุฉ
    const frames = ["โณ Checking...", "โ Checking..."];
    let i = 0;

    startButton.innerText = frames[i];

    // ุชุดุบูู ุงูุญุฑูุฉ
    const interval = setInterval(() => {
        i = (i + 1) % frames.length;
        startButton.innerText = frames[i];
    }, 600); // ุชุบููุฑ ูู 0.6 ุซุงููุฉ

    // ุญูุธ ุงูู interval ุฏุงุฎู ุงูุฒุฑ ุนุดุงู ููููู ุจุนุฏ ุงูุชุญูู
    startButton.dataset.loadingInterval = interval;
}


  // ุชุญูู ูู ุงูุชูุฑุงุฑ ุนูู ุงูุณูุฑูุฑ
  const quizName = course || "Unknown";
  let check;
  try {
    check = await checkDuplicate(name, phone, quizName);
    console.log("Data from server:", check);
  } catch (err) {
    console.error(err);
    alert("โ ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุงูุงุชุตุงู ุจุงูุณูุฑูุฑ.");
    if (startButton) {
      startButton.disabled = false;
      startButton.innerText = prevText;
    }
    return;
  }

  // ุฅุนุงุฏุฉ ุงูุฒุฑ ููุถุนู ุงูุทุจูุนู
  if (startButton) {
    startButton.disabled = false;
    startButton.innerText = prevText;
  }

  // ููุน ุงูุฏุฎูู ุฅุฐุง ูุงู ููุฑุฑ
  if (!check.ok) {
    showDuplicateMessage(check.message);
    return;
  }

  // ูู ูู ุดูุก ุชูุงู: ุถุน ุจูุงูุงุช ุงููุชุฏุฑุจ ูุงุจุฏุฃ ุงูุงูุชุญุงู
  quizTitle.textContent = course || "(ุชุนุงูุฏุงุช)";
  window.traineeData = { name, phone, traineeCode, course };

  document.getElementById("startScreen").style.display = "none";
  document.getElementById("quizContainer").style.display = "block";

  startTime = new Date();
  startTimer();
  loadTFQuestion();

  // ุชุดุบูู ูุถุน ููุก ุงูุดุงุดุฉ
  let elem = document.documentElement;
  if (elem.requestFullscreen) { elem.requestFullscreen(); }
  else if (elem.mozRequestFullScreen) { elem.mozRequestFullScreen(); }
  else if (elem.webkitRequestFullscreen) { elem.webkitRequestFullscreen(); }
  else if (elem.msRequestFullscreen) { elem.msRequestFullscreen(); }
}

    
function showDuplicateMessage(message) {
    const msgBox = document.getElementById("duplicateMessage");
    const msgText = document.getElementById("duplicateText");

    msgText.textContent = message || "โ ุชู ุงูุชุณุฌูู ูุณุจููุง ูู ูุฐุง ุงูุงุฎุชุจุงุฑ.";
    msgBox.style.display = "flex";

    // ุงุฎุชูุงุก ุงูุฑุณุงูุฉ ุจุนุฏ 3 ุซูุงูู
    setTimeout(() => {
        msgBox.style.display = "none";
    }, 3000);
}



        function startTimer() {
            timerInterval = setInterval(() => {
                let minutes = Math.floor(timeLeft / 60);
                let seconds = timeLeft % 60;
                document.getElementById("timer").innerText = `Time Remaining: ${minutes}:${seconds < 10 ? '0' : ''}${seconds}`;
                if (timeLeft <= 0) {
                    clearInterval(timerInterval);
                    showResult();
                }
                timeLeft--;
            }, 1000);
        }
    
      function loadTFQuestion() {
    let quizDiv = document.getElementById("quiz");
    let passageDiv = document.getElementById("passage");

    if (currentTFQuestion < trueFalseQuestions.length) {
        let q = trueFalseQuestions[currentTFQuestion];

        // ุนุฑุถ ุงูููุทุน
        passageDiv.innerHTML = `
            <p style="font-size: 22px;">${q.passage}</p>
        `;

        // ุนุฑุถ ุงูุณุคุงู ูุงูุงุฎุชูุงุฑุงุช
        let questionHTML = `<p class='question'><strong>${currentTFQuestion + 1}- ${q.q}</strong></p>`;

        q.options.forEach((option, index) => {
    const letter = String.fromCharCode(97 + index); // "a", "b", ...
    questionHTML += `
        <label>
            <input type='radio' name='answer' value='${letter}'>
            ${option}
        </label><br>
    `;
});

        questionHTML += `<button class='btn' onclick='nextTFQuestion()'>Next</button>`;
        quizDiv.innerHTML = questionHTML;
    } else {
        // ุงูุงูุชูุงุก ูู ุนุฑุถ ูู ุงูุฃุณุฆูุฉ
        document.getElementById("passage").style.display = "none";
        quizDiv.innerHTML = "<p>You've finished all reading questions.</p>";
        loadQuestion(); // ูู ููู ูุฑุญูุฉ ุชุงููุฉ
    }
}

    
  function nextTFQuestion() {
  const selectedAnswer = document.querySelector("input[name='answer']:checked");
  if (!selectedAnswer) {
    alert("Please select an answer");
    return;
  }

  const q = trueFalseQuestions[currentTFQuestion];
  const selectedValue = selectedAnswer.value;

  const isAnswerKeyALetter = q.a.length === 1 && ["a", "b", "c", "d"].includes(q.a.toLowerCase());

  if (isAnswerKeyALetter) {
    if (selectedValue === q.a.toLowerCase()) {
      tfCorrectAnswers++; // โ ุตุญุญ ููุง ุจุฏู score
    }
  } else {
    const selectedOptionIndex = selectedValue.charCodeAt(0) - 97;
    const selectedOptionText = q.options[selectedOptionIndex];

    if (selectedOptionText.trim().toLowerCase() === q.a.trim().toLowerCase()) {
      tfCorrectAnswers++; // โ ุตุญุญ ููุง ุจุฏู score
    }
  }

  currentTFQuestion++;
  loadTFQuestion();
}




        function loadQuestion() {
            let quizDiv = document.getElementById("quiz");
            let q = questions[currentQuestion];
            quizDiv.innerHTML = `<p class='question'>${q.q}</p>` +
                q.options.map((option, index) => `<label><input type='radio' name='answer' value='${String.fromCharCode(97 + index)}'> ${option}</label>`).join('') +
                `<button class='btn' onclick='nextQuestion()'>${currentQuestion === questions.length - 1 ? "Finish" : "Next"}</button>`;
        }
    
        function nextQuestion() {
            let selectedAnswer = document.querySelector("input[name='answer']:checked");
            if (!selectedAnswer) return;
            if (selectedAnswer.value === questions[currentQuestion].a) {
                correctAnswers++;
            }
            if (currentQuestion < questions.length - 1) {
                currentQuestion++;
                loadQuestion();
            } else {
                showResult();
            }
        }
    
let serverUrl = ""; // ุณูุชู ุชุญุฏูุซู ุชููุงุฆููุง ุนูุฏ ุชุญููู ุงูุตูุญุฉ

// ุฏุงูุฉ ูุฌูุจ ุฑุงุจุท ุงูุณูุฑูุฑ ุงููุฎุฒู ูู GitHub
function fetchServerUrl() {
fetch("https://raw.githubusercontent.com/etiqotwf/liveServer1/main/serverUrl.json")
        .then(response => response.json())
        .then(data => {
            if (data.serverUrl) {
                serverUrl = data.serverUrl;
                console.log("โ ุฑุงุจุท ุงูุณูุฑูุฑ ุงููุญุฏุซ ูู GitHub:", serverUrl);
            } else {
                console.error("โ ูู ูุชู ุงูุนุซูุฑ ุนูู ุฑุงุจุท ุงูุณูุฑูุฑ ูู ุงููุณุชูุฏุน.");
                retryFetchServerUrl();
            }
        })
        .catch(error => {
            console.error("โ ุฎุทุฃ ูู ุฌูุจ ุฑุงุจุท ุงูุณูุฑูุฑ ูู GitHub:", error);
            retryFetchServerUrl();
        });
}

// ุฏุงูุฉ ูุฅุนุงุฏุฉ ุงููุญุงููุฉ ุนูุฏ ุงููุดู
function retryFetchServerUrl() {
    if (retryCount < MAX_RETRIES) {
        retryCount++;
        console.log(`๐ ุฅุนุงุฏุฉ ุงููุญุงููุฉ (${retryCount}/${MAX_RETRIES}) ุจุนุฏ 3 ุซูุงูู...`);
        setTimeout(fetchServerUrl, 3000);
    } else {
        console.error("โ ุชู ุงููุตูู ุฅูู ุงูุญุฏ ุงูุฃูุตู ูู ุงููุญุงููุงุชุ ุชุนุฐุฑ ุฌูุจ ุฑุงุจุท ุงูุณูุฑูุฑ.");
    }
}

// ุชุญููู ุฑุงุจุท ุงูุณูุฑูุฑ ุนูุฏ ูุชุญ ุงูุตูุญุฉ
fetchServerUrl();
function showResult() {
    // ุฅููุงู ุงููุคูุช
    clearInterval(timerInterval);

    // โ ุชุญููู ุจูุงูุงุช ุงููุชุฏุฑุจ ูู window (ุนุดุงู ููุธูุฑุด undefined)
    const traineeData = window.traineeData || {};

    // ุญุณุงุจ ุงูููุช ุงููุณุชุบุฑู
    let endTime = new Date();
    let timeTaken = Math.floor((endTime - startTime) / 1000);
    let minutesTaken = Math.floor(timeTaken / 60);
    let secondsTaken = timeTaken % 60;

    // ุฌูุน ุจูุงูุงุช ุงููุชุฏุฑุจ
    let name = traineeData.name || document.getElementById("traineeName").value || "Unknown";
    let phone = traineeData.phone || document.getElementById("traineePhone").value || "Unknown";
    let traineeCode = traineeData.traineeCode || document.getElementById("traineeCode").value || "Unknown";
    let date = new Date().toLocaleDateString("en-US");
    let course = traineeData.course || document.getElementById("courseName").value || "Unknown";

    // ุญุณุงุจ ุงููุชูุฌุฉ
    let totalQuestions = trueFalseQuestions.length + questions.length;
    let totalCorrectAnswers = tfCorrectAnswers + correctAnswers;

    // ุจูุงูุงุช ุงููุชูุฌุฉ
    let resultData = {
        name,
        phone,
        traineeCode,
        date,
        course,
        startTime: startTime.toLocaleString("en-GB", {
            timeZone: "Africa/Cairo",
            year: "numeric",
            month: "long",
            day: "numeric",
            hour: "numeric",
            minute: "numeric",
            second: "numeric",
            hour12: true
        }),
        timeTaken: `${minutesTaken} min ${secondsTaken} sec`,
        score: `${totalCorrectAnswers} / ${totalQuestions}`
    };

    // ุฅุฑุณุงู ุงูุจูุงูุงุช ููุณูุฑูุฑ ุฅุฐุง ุชู ุชุญููู ุงูุฑุงุจุท
    if (!serverUrl) {
        console.log("โณ ุงูุชุธุงุฑ ุชุญููู ุฑุงุจุท ุงูุณูุฑูุฑ...");
        fetchServerUrl().then(() => {
            if (serverUrl) sendDataToServer(resultData);
            else {
                console.error("โ ูู ูุชู ุชุญููู ุฑุงุจุท ุงูุณูุฑูุฑ ุจุนุฏ.");
                alert("โ๏ธ ุชุนุฐุฑ ุฅุฑุณุงู ุงูุจูุงูุงุช! ุชุฃูุฏ ูู ุงุชุตุงู ุงูุฅูุชุฑูุช ูุฃุนุฏ ุงููุญุงููุฉ.");
            }
        });
    } else sendDataToServer(resultData);

    // ุฅุฑุณุงู ุงูุจูุงูุงุช ุฅูู Google Sheets
    sendDataToGoogleSheet(resultData);

    // ุชุญุฏูุซ ูุงุฌูุฉ ุงููุณุชุฎุฏู
    document.getElementById("resultCourse").innerText = course;
    document.getElementById("resultName").innerText = name;
    document.getElementById("resultPhone").innerText = phone;
    document.getElementById("resultCode").innerText = traineeCode; // โ ุงูููุฏ ููุธูุฑ ุตุญ ุฏูููุชู
    document.getElementById("resultDate").innerText = date;
    document.getElementById("resultStartTime").innerText = startTime.toLocaleTimeString();
    document.getElementById("resultTime").innerText = `${minutesTaken} min ${secondsTaken} sec`;
    document.getElementById("resultScore").innerText = `${totalCorrectAnswers} / ${totalQuestions}`;

    // ุนุฑุถ ุงูุชูุฏูุฑ
    displayRatingFromNumber(totalCorrectAnswers, totalQuestions);

    // ุนููุงู ุงููุชูุฌุฉ ูุงูุฃูุนุงุจ ุงููุงุฑูุฉ
    const title = document.getElementById('resultTitle');
    const scorePercentage = totalCorrectAnswers / totalQuestions;
    if(scorePercentage >= 0.20){
        title.innerText = "๐ Congratulations! ๐";
        launchFireworks();
    } else {
        title.innerText = "๐ Better luck next time!";
    }

    // ุฅุธูุงุฑ ุดุงุดุฉ ุงููุชูุฌุฉ ูุฅุฎูุงุก ุงูุงุฎุชุจุงุฑ
    document.getElementById("quizContainer").style.display = "none";
    document.getElementById("resultScreen").style.display = "block";
}


// ุฅุฑุณุงู ุงูุจูุงูุงุช ุฅูู ุงูุณูุฑูุฑ ุงูุฃุณุงุณู
function sendDataToServer(resultData) {
    fetch(`${serverUrl}/submit`, {
        method: "POST",
        headers: {
            "Content-Type": "application/json"
        },
        body: JSON.stringify(resultData)
    })
    .then(response => response.json())
    .then(data => console.log("โ ุชู ุงูุฅุฑุณุงู ุฅูู ุงูุณูุฑูุฑ ุจูุฌุงุญ:", data))
    .catch(error => console.error("โ ุฎุทุฃ ุฃุซูุงุก ุงูุฅุฑุณุงู ุฅูู ุงูุณูุฑูุฑ:", error));
}



// ๐ ุฅุฑุณุงู ุงูุจูุงูุงุช ูุน retry ูุญูุธ ูุญูู ุนูุฏ ุงููุดู
async function sendDataToGoogleSheet(resultData) {
  const maxRetries = 5; // ุนุฏุฏ ุงููุญุงููุงุช
  let attempt = 0;
  let success = false;

  while (!success && attempt < maxRetries) {
    try {
      const formData = new URLSearchParams();
      formData.append("course", resultData.course);
      formData.append("name", resultData.name);
      formData.append("phone", resultData.phone);
      formData.append("date", resultData.date);
      formData.append("startTime", resultData.startTime);
      formData.append("timeTaken", resultData.timeTaken);
      formData.append("score", resultData.score);
      formData.append("traineeCode", resultData.traineeCode);

      const response = await fetch("https://script.google.com/macros/s/AKfycbw9uYQeLP2gC-x21seAYkKmbruvkaghYqUzm25dg4EbHlsBUs4ZSq8GRIV68zD9vO4WXw/exec", {
        method: "POST",
        headers: { "Content-Type": "application/x-www-form-urlencoded" },
        body: formData.toString()
      });

      const text = await response.text();
      console.log("โ ุชู ุงูุฅุฑุณุงู ุฅูู Google Sheet:", text);
      success = true;

    } catch (error) {
      attempt++;
      console.warn(`Attempt ${attempt} failed:`, error);

      if (attempt >= maxRetries) {
        console.error("โ ูุดู ุงูุฅุฑุณุงู ุจุนุฏ ุนุฏุฉ ูุญุงููุงุชุ ุณูุชู ุญูุธ ุงูุจูุงูุงุช ูุญูููุง.");
        saveLocally(resultData);
      } else {
        // ุงูุชุธุงุฑ 2 ุซุงููุฉ ูุจู ุฅุนุงุฏุฉ ุงููุญุงููุฉ
        await new Promise(r => setTimeout(r, 2000));
      }
    }
  }
}

// ๐ ุญูุธ ุงูุจูุงูุงุช ูุญูููุง ูุชุฌุฑุจุฉ ุงูุฅุฑุณุงู ูุงุญููุง
function saveLocally(resultData) {
  let pending = JSON.parse(localStorage.getItem("pendingResults") || "[]");
  pending.push(resultData);
  localStorage.setItem("pendingResults", JSON.stringify(pending));
}

// ๐ ุฅุนุงุฏุฉ ุฅุฑุณุงู ุงูุจูุงูุงุช ุงููุญููุธุฉ ุนูุฏ ูุชุญ ุงูุตูุญุฉ ุฃู ุนูุฏุฉ ุงููุช
async function retryPendingResults() {
  let pending = JSON.parse(localStorage.getItem("pendingResults") || "[]");
  if (!pending.length) return;

  for (let i = 0; i < pending.length; i++) {
    try {
      await sendDataToGoogleSheet(pending[i]);
      pending.splice(i, 1);
      i--;
    } catch(e) {
      console.warn("Retry failed for one entry", e);
    }
  }
  localStorage.setItem("pendingResults", JSON.stringify(pending));
}

// ๐ ุนูุฏ ูุชุญ ุงูุตูุญุฉ ุญุงูู ุฅุนุงุฏุฉ ุฅุฑุณุงู ุงููุชุงุฆุฌ ุงููุนููุฉ
window.addEventListener("load", retryPendingResults);



    </script>
    </body>
</html>
