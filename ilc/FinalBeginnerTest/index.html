<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Reading Comprehension Quiz</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      text-align: center;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-start;
      margin: 0;
      background: #1e1e2e;
      color: white;
    }

    .container {
      margin-top: 5px;
      width: 95%;
      max-width: 1200px;
      background: #282a36;
      padding: 10px 30px 30px;
      border-radius: 10px;
      box-shadow: 0px 0px 15px rgba(0, 0, 0, 0.5);
      text-align: left;
    }

    h1, h2, p { margin-top: 0; }

    .question {
      font-weight: bold;
      font-size: 30px;
      margin-bottom: 20px;
    }

    .options label {
      display: block;
      padding: 10px;
    }

    .btn {
      background: #ff5555;
      color: white;
      border: none;
      padding: 12px 25px;
      cursor: pointer;
      border-radius: 5px;
      margin-top: 200px;
      font-size: 18px;
      display: block;
    }

    .btn:hover { background: #ff79c6; }

    .result-screen {
      display: none;
      background: #44475a;
      padding: 30px;
      border-radius: 10px;
      text-align: center;
      width: 100%;
    }

    #resultScore {
      font-size: 36px;
      font-weight: bold;
      color: #ffffff;
      margin-top: 20px;
    }

    .result-screen p {
      font-size: 20px;
      font-weight: bold;
      color: #f8f8f2;
    }

    #timer {
  font-size: 28px;
  color: #222; /* لون غامق عشان يظهر فوق الخلفية البيضاء */
  font-weight: bold;
  background: rgba(255, 215, 0, 0.2); /* خلفية شفافة ذهبية خفيفة */
  padding: 10px 20px;
  border-radius: 10px;
  width: fit-content;
  margin: 20px auto;
  position: relative;
  z-index: 2;
  box-shadow: 0 0 10px rgba(0,0,0,0.1);
}


    .author {
      font-size: 30px;
      color: #eb2d0b;
      text-align: center;
      font-weight: bold;
      margin-bottom: 15px;
    }

    label {
      font-size: 22px;
      padding: 10px;
      display: block;
    }

    input[type="radio"] {
      transform: scale(1.5);
      margin-right: 10px;
    }

    #passage { font-size: 16px; font-weight: bold; }

    #startScreen p {
      font-size: 22px;
      font-weight: bold;
    }

    #startScreen input {
      font-size: 20px;
      font-weight: bold;
      padding: 8px;
    }

    #startScreen h1 {
      font-size: 40px;
      font-weight: bold;
      color: #ffd700;
      text-align: center;
      margin-bottom: 20px;
    }

    /* شاشة الأسئلة البيضاء */
    #quizContainer {
      display: none;
      position: relative;
      background: #ffffff;
      color: #000;
      border-radius: 25px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.2);
      padding: 40px;
      max-width: 1000px;
      text-align: left;
      overflow: hidden;
    }

    

    /* اللوجو الشفاف في المنتصف */
    #quizContainer::before {
      content: "";
      position: absolute;
      inset: 0;
      background: url('ilc.jpg') center center no-repeat;
      background-size: 60%;
      opacity: 0.2;
      z-index: 0;
    }

    #quizContainer > * { position: relative; z-index: 1; }

    @keyframes fall {
      to { transform: translateY(110vh); opacity: 0.5; }
    }
  </style>
</head>

<body>

  <!-- شاشة البداية -->
  <div class="container" id="startScreen" style="
    max-width: 700px; 
    margin: 60px auto; 
    padding: 40px; 
    background: #ffffff; 
    border-radius: 25px; 
    box-shadow: 0 10px 30px rgba(0,0,0,0.2); 
    text-align: center; 
    font-family: 'Trebuchet MS', sans-serif;
    position: relative;
    overflow: hidden;
  ">
    <h1 style="color:#0056b3; font-size: 40px; margin-bottom: 20px;">
      🤖 The British International Learning Center (ILC)
    </h1>
    <h2 style="font-size: 26px; color:#444; margin-bottom: 30px;">✨ AI-Powered Training Portal ✨</h2>

    <p style="font-size: 20px;">
      📘 Course Name: 
      <input type="text" id="courseName" value="FinalBeginnerTest" readonly 
        style="font: size 25px;; padding:12px; width:60%; border:none; border-radius:8px; background:#f0f0f0; text-align:center;">
    </p>

    <p style="font-size: 20px;">
      👤 Enter Your Name: 
      <input type="text" id="traineeName" placeholder="Type your name..." 
        style="font-size:18px; padding:12px; width:60%; border:1px solid #ccc; border-radius:8px; text-align:center;">
    </p>

    <p style="font-size: 20px;">
      📱 Enter Your Phone Number: 
      <input type="text" id="traineePhone" placeholder="Type your phone number..." 
        style="font-size:18px; padding:12px; width:60%; border:1px solid #ccc; border-radius:8px; text-align:center;">
    </p>

    <p style="font-size: 20px;">
      🔑 Enter Password: 
      <input type="password" id="password" placeholder="Enter password..." 
        style="font-size:18px; padding:12px; width:60%; border:1px solid #ccc; border-radius:8px; text-align:center;">
    </p>

    <button class="btn" onclick="startQuiz()" style="
      margin-top: 25px; 
      font-size: 22px; 
      padding: 15px 40px; 
      border:none; 
      border-radius:12px; 
      background: linear-gradient(135deg, #007bff, #00d4ff); 
      color:white; 
      cursor:pointer; 
      box-shadow:0 8px 20px rgba(0,0,0,0.2); 
      transition: transform 0.2s;
    " onmouseover="this.style.transform='scale(1.1)'" 
       onmouseout="this.style.transform='scale(1)'">
      🚀 Start Quiz
    </button>

    <p style="margin-top: 40px; font-size: 18px; color: gray;">
      ✍️ Edited by: Ahmed Amer
    </p>


    

    <div id="emojiRain" style="
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      font-size: 2rem;
    "></div>
  </div>

  <!-- شاشة الأسئلة -->
  <div class="container" id="quizContainer">
    <h2 id="quizTitle">Placement Test</h2>
    <p class="author">📘 The British International Learning Center (ILC)</p>
    <p>Date: <span id="date"></span></p>
     <!-- Emoji Sticky Animation -->
 <div id="emoji-character" style="
    position: sticky;
    top: 10px;
    float: right;
    margin-left: auto;
    display: block;
    z-index: 10;
">
  <img src="ilc.jpg" alt="ILC Logo" style="
      width: 180px;
      height: auto;
      border-radius: 12px;
      box-shadow: 0 0 12px rgba(0,0,0,0.3);
  ">
</div>

    <p id="timer"> ----- </p>
    <div id="passage">
      <h3>Read the following passage carefully and answer the following questions:</h3>
      <p style="font-size: 22px;"></p>
    </div>
    <div id="quiz"></div>

  
  </div>


  
  <!-- شاشة النتيجة -->
  <div class="result-screen" id="resultScreen">
    <h2>Test Result</h2>
    <p class="author">Created by: Ahmed Amer</p>
    <p><strong>Course Name:</strong> <span id="resultCourse"></span></p>
    <p><strong>Name:</strong> <span id="resultName"></span></p>
    <p><strong>Phone Number:</strong> <span id="resultPhone"></span></p>
    <p><strong>Test Date:</strong> <span id="resultDate"></span></p>
    <p><strong>Start Time:</strong> <span id="resultStartTime"></span></p>
    <p><strong>Time Taken:</strong> <span id="resultTime"></span></p>
    <p><strong>Score:</strong> <span id="resultScore"></span></p>
  </div>

  <script>
    // إيموجي المطر فقط في الشاشة الافتتاحية
    const emojis = ["📝","✏️","📘","📖","⏳","🎯","🏆","📊","👨‍🎓"];
    const container = document.getElementById("emojiRain");
    let rainInterval;

    function createEmoji() {
      const emoji = document.createElement("div");
      emoji.innerText = emojis[Math.floor(Math.random() * emojis.length)];
      emoji.style.position = "absolute";
      emoji.style.left = Math.random() * 100 + "vw";
      emoji.style.top = "-50px";
      emoji.style.fontSize = "28px";
      emoji.style.animation = `fall ${6 + Math.random() * 3}s linear`;
      container.appendChild(emoji);
      setTimeout(() => emoji.remove(), 2000);
    }

    function startEmojiRain() {
      rainInterval = setInterval(createEmoji, 500);
    }

    function stopEmojiRain() {
      clearInterval(rainInterval);
      container.innerHTML = "";
    }

    startEmojiRain();

    function startQuiz() {
      document.getElementById("startScreen").style.display = "none";
      document.getElementById("quizContainer").style.display = "block";
      stopEmojiRain();
    }
  </script>


  


<script>
    // عند الضغط على أي مكان في الصفحة، أدخل وضع ملء الشاشة
    document.addEventListener("click", () => {
      const elem = document.documentElement; // أو document.getElementById("myForm")
      if (document.fullscreenElement) return; // لا تفعل شيء إذا كنا بالفعل في ملء الشاشة

      if (elem.requestFullscreen) {
        elem.requestFullscreen();
      } else if (elem.webkitRequestFullscreen) { /* Safari */
        elem.webkitRequestFullscreen();
      } else if (elem.msRequestFullscreen) { /* IE11 */
        elem.msRequestFullscreen();
      }
    });
  </script>

    
   <script>
        document.getElementById("date").innerText = new Date().toLocaleDateString("en-US");
    
   const trueFalseQuestions = [
  {
    passage: `Leaving Home<br>
Young people leave their parents' homes at different ages in different parts of the world. In the United States, a lot of college students do not live at home. They often choose to go to college in different cities – away from their parents. At college, many live in university housing. After college, most people prefer to live in their own homes. They often live alone, but some people rent apartments with others. These people are called roommates.
By the age of 22, few young people in the United States live with their parents. Families stay together longer in many Asian countries and cities. In Hong Kong, for example, nearly all university students live with their parents. Rents in the city are very expensive, and few students have the money to pay for their own apartments. Very few young people live alone or become roommates in a shared apartment. Many young people in Hong Kong continue to live with their parents even after they marry.`,
    q: " In the United States, very few students live in university housing.",
    a: "False",
    options: ["True", "False"]
  },
  {
    passage: `Leaving Home<br>
Young people leave their parents' homes at different ages in different parts of the world. In the United States, a lot of college students do not live at home. They often choose to go to college in different cities – away from their parents. At college, many live in university housing. After college, most people prefer to live in their own homes. They often live alone, but some people rent apartments with others. These people are called roommates.
By the age of 22, few young people in the United States live with their parents. Families stay together longer in many Asian countries and cities. In Hong Kong, for example, nearly all university students live with their parents. Rents in the city are very expensive, and few students have the money to pay for their own apartments. Very few young people live alone or become roommates in a shared apartment. Many young people in Hong Kong continue to live with their parents even after they marry.`,
    q: " In the United States, some young adults share apartments with roommates.",
    a: "True",
    options: ["True", "False"]
  },
  {
    passage: `Leaving Home<br>
Young people leave their parents' homes at different ages in different parts of the world. In the United States, a lot of college students do not live at home. They often choose to go to college in different cities – away from their parents. At college, many live in university housing. After college, most people prefer to live in their own homes. They often live alone, but some people rent apartments with others. These people are called roommates.
By the age of 22, few young people in the United States live with their parents. Families stay together longer in many Asian countries and cities. In Hong Kong, for example, nearly all university students live with their parents. Rents in the city are very expensive, and few students have the money to pay for their own apartments. Very few young people live alone or become roommates in a shared apartment. Many young people in Hong Kong continue to live with their parents even after they marry.`,
    q: " In the United States, nearly all young adults live with their parents.",
    a: "False",
    options: ["True", "False"]
  },
  {
    passage: `Leaving Home<br>
Young people leave their parents' homes at different ages in different parts of the world. In the United States, a lot of college students do not live at home. They often choose to go to college in different cities – away from their parents. At college, many live in university housing. After college, most people prefer to live in their own homes. They often live alone, but some people rent apartments with others. These people are called roommates.
By the age of 22, few young people in the United States live with their parents. Families stay together longer in many Asian countries and cities. In Hong Kong, for example, nearly all university students live with their parents. Rents in the city are very expensive, and few students have the money to pay for their own apartments. Very few young people live alone or become roommates in a shared apartment. Many young people in Hong Kong continue to live with their parents even after they marry.`,
    q: " In Hong Kong, not many university students live with their parents.",
    a: "False",
    options: ["True", "False"]
  },
  {
    passage: `Leaving Home<br>
Young people leave their parents' homes at different ages in different parts of the world. In the United States, a lot of college students do not live at home. They often choose to go to college in different cities – away from their parents. At college, many live in university housing. After college, most people prefer to live in their own homes. They often live alone, but some people rent apartments with others. These people are called roommates.
By the age of 22, few young people in the United States live with their parents. Families stay together longer in many Asian countries and cities. In Hong Kong, for example, nearly all university students live with their parents. Rents in the city are very expensive, and few students have the money to pay for their own apartments. Very few young people live alone or become roommates in a shared apartment. Many young people in Hong Kong continue to live with their parents even after they marry.`,
    q: " In Hong Kong, few young people live alone.",
    a: "True",
    options: ["True", "False"]
  },
  {
    passage: `Leaving Home<br>
Young people leave their parents' homes at different ages in different parts of the world. In the United States, a lot of college students do not live at home. They often choose to go to college in different cities – away from their parents. At college, many live in university housing. After college, most people prefer to live in their own homes. They often live alone, but some people rent apartments with others. These people are called roommates.
By the age of 22, few young people in the United States live with their parents. Families stay together longer in many Asian countries and cities. In Hong Kong, for example, nearly all university students live with their parents. Rents in the city are very expensive, and few students have the money to pay for their own apartments. Very few young people live alone or become roommates in a shared apartment. Many young people in Hong Kong continue to live with their parents even after they marry.`,
    q: " In Hong Kong, most young married couples have enough money to live in their own apartments.",
    a: "False",
    options: ["True", "False"]
  }
];

    
const questions = [
  { q: "7- Who -----------------------the men over there, Amy?", a: "c", options: ["am", "is", "are", "was"] },
  { q: "8- A: My name is Young-hoon. B: -----------------------------", a: "a", options: ["Nice to meet you, Young-hoon", "Let's go and say hello", "It's too expensive", "I can't afford that"] },
  { q: "9- That's Ji-Won. ------------------is in my class.", a: "a", options: ["He", "His", "We", "Her"] },
  { q: "10- A: Hello. I'm a new club member. B: -----------------------------", a: "b", options: ["Thanks", "Welcome", "Goodbye", "Not at all"] },
  { q: "11- I'm a --------------------------. I work in an office. I like computers a lot.", a: "b", options: ["fitness instructor", "website designer", "flight attendant", "tour guide"] },
  { q: "12- What do you ---------------?", a: "d", options: ["doing", "does", "did", "do"] },
  { q: "13- I'm a student. I ------------architecture.", a: "a", options: ["study", "studying", "studies", "has studied"] },
  { q: "14- Eyad works for ---------------Construction Company.", a: "c", options: ["the", "an", "a", "no article"] },
  { q: "15- -----------Saturdays and Sundays, Pat sleeps most of the day and wakes up a little late.", a: "d", options: ["In", "Until", "At", "On"] },
  { q: "16- Lauren --------------------work at 5:00 p.m.", a: "b", options: ["answers", "starts", "goes", "writes"] },
  { q: "17- ------------size do you want to try?", a: "c", options: ["Where", "When", "What", "Who"] },
  { q: "18- How much is ----------------backpack?", a: "a", options: ["this", "these", "those", "then"] },
  { q: "19- You mean the green ones, -------------------$34.", a: "b", options: ["It's", "They're", "We're", "He's"] },
  { q: "20- The leather gloves are ------------than the woolen ones.", a: "c", options: ["nice", "nicest", "nicer", "more than"] },
  { q: "21- The knife is made ---------------------diamonds.", a: "b", options: ["from", "of", "into", "off"] },
  { q: "22- A: Do you like country music?  B: -------------------------------------", a: "a", options: ["I can't stand it", "I can't stand them", "It's out of my hand", "It's well-cooked"] },
  { q: "23- I love the daughter of my brother as she is my favorite ------------------", a: "b", options: ["nephew", "niece", "widower", "aunt"] },
  { q: "24- Very ---------------students live in university housing.", a: "d", options: ["much", "little", "less", "few"] },
  { q: "25- In my country, some ----------------get married fairly young.", a: "a", options: ["couples", "cousins", "relatives", "person"] },
  { q: "26- I almost never -----------------bicycling.", a: "c", options: ["play", "do", "go", "give"] },
  { q: "27- Do you also play sports -----------------your free time?", a: "b", options: ["at", "in", "until", "from"] },
  { q: "28- Pierre never -------------------. He's a real couch potato.", a: "b", options: ["arises", "exercises", "absorbs", "sterilizes"] },
  { q: "29- A: How often do you go swimming, Linda? B: ------------------------------------", a: "b", options: ["I guess I'm ok.", "Once a week", "About an hour.", "No one knows"] },
  { q: "30- Philip tries to keep fit. He wants to stay in ------------------", a: "c", options: ["form", "model", "shape", "bait"] },
  { q: "31- I'd prefer to ----------------my homework in the evening.", a: "b", options: ["make", "do", "give", "have"] },
  { q: "32- He was ---------------------last week. He spent all his money.", a: "b", options: ["break", "broke", "broken", "breaking"] },
  { q: "33- He didn't work ---------------Friday. He took a day off.", a: "b", options: ["in", "on", "at", "of"] },
  { q: "34- My friend spent two hours ------------------the newest movie online.", a: "d", options: ["watch", "watched", "to watch", "watching"] },
  { q: "35- We didn't have time to visit any ------------------ temples.", a: "a", options: ["other", "another", "others", "rather"] },
  { q: "36- What's your neighborhood -------------------?", a: "b", options: ["alike", "like", "likely", "liked"] },
  { q: "37- I'm sorry I was late. I had to ----------------a phone call.", a: "b", options: ["do", "make", "go", "get"] },
  { q: "38- My friends and I really enjoyed your party. We all had a -----------------time.", a: "b", options: ["boring", "good", "funny", "dull"] },
  { q: "39- I stayed home last night and -------------------the laundry.", a: "a", options: ["did", "went", "made", "shot"] },
  { q: "40- We didn't see very much in the mountains. The weather was pretty --------------------------", a: "b", options: ["cool", "foggy", "sunny", "clear"] },
  { q: "41- I worked really hard in Switzerland last week. I was there -----------------------.", a: "b", options: ["in my car", "on business", "on vacation", "by yacht"] },
  { q: "42- I had my hair cut at the -------------------", a: "b", options: ["butcher's", "barber's", "greengrocer's", "banker's"] },
  { q: "43- There is one ----------to the grocery store on 1st Avenue.", a: "d", options: ["between", "in front", "opposite", "next"] },
  { q: "44- How much noise ---------------------there?", a: "a", options: ["is", "are", "has", "have"] },
  { q: "45- I'm going to the stationery store to get a ---------------------------", a: "a", options: ["birthday card", "coffee", "food", "ointment"] },
  { q: "46- We're taking a long drive. We need to go to the ----------------------", a: "b", options: ["Laundromat", "gas station", "travel agency", "carpenter workshop"] },
  { q: "47- I live on the 8th floor of my -----------------------------", a: "a", options: ["apartment building", "neighborhood", "theater", "aquarium"] },
  { q: "48- Our apartment is in the center of the city. We live ----------------------------", a: "a", options: ["downtown", "in the neighborhood", "in the suburbs", "in the outskirts"] },
  { q: "49- I start work -------------------7:30 a.m. and I work until 3:30.", a: "b", options: ["in", "at", "on", "early"] },
  { q: "50- Sayed Darwish was the -------------------of his family.", a: "b", options: ["working class", "breadwinner", "exile", "patriot"] }
];



    
        let currentTFQuestion = 0;
        let tfCorrectAnswers = 0;
        let currentQuestion = 0;
        let correctAnswers = 0;
        let timeLeft = 3600;
        let timerInterval;
        let startTime;
    
        function startQuiz() {
    let name = document.getElementById("traineeName").value.trim();
    let phone = document.getElementById("traineePhone").value.trim();
    let password = document.getElementById("password").value;
    let course = document.getElementById("courseName").value.trim(); // 🆕 قراءة اسم الكورس
    let quizTitle = document.getElementById("quizTitle"); // 🆕 العنوان اللي هيتغير

    if (!name) {
        alert("❗ برجاء إدخال الاسم.");
        return;
    }

    if (!phone) {
        alert("❗ برجاء إدخال رقم التليفون.");
        return;
    }

    if (password !== "1550") {
        alert("❌ كلمة المرور غير صحيحة! الرجاء المحاولة مرة أخرى.");
        return;
    }

    // 🆕 تغيير العنوان بناءً على اسم الكورس
    quizTitle.textContent = course || "FinalBeginnerTest";

    document.getElementById("startScreen").style.display = "none";
    document.getElementById("quizContainer").style.display = "block";
    startTime = new Date();
    startTimer();
    loadTFQuestion();

    // تشغيل وضع ملء الشاشة
    let elem = document.documentElement;
    if (elem.requestFullscreen) {
        elem.requestFullscreen();
    } else if (elem.mozRequestFullScreen) {
        elem.mozRequestFullScreen();
    } else if (elem.webkitRequestFullscreen) {
        elem.webkitRequestFullscreen();
    } else if (elem.msRequestFullscreen) {
        elem.msRequestFullscreen();
    }
}



    
        function startTimer() {
            timerInterval = setInterval(() => {
                let minutes = Math.floor(timeLeft / 60);
                let seconds = timeLeft % 60;
                document.getElementById("timer").innerText = `Time Remaining: ${minutes}:${seconds < 10 ? '0' : ''}${seconds}`;
                if (timeLeft <= 0) {
                    clearInterval(timerInterval);
                    showResult();
                }
                timeLeft--;
            }, 1000);
        }
    
      function loadTFQuestion() {
    let quizDiv = document.getElementById("quiz");
    let passageDiv = document.getElementById("passage");

    if (currentTFQuestion < trueFalseQuestions.length) {
        let q = trueFalseQuestions[currentTFQuestion];

        // عرض المقطع
        passageDiv.innerHTML = `
            <h3>Read the following passage carefully and answer the question:</h3>
            <p style="font-size: 22px;">${q.passage}</p>
        `;

        // عرض السؤال والاختيارات
        let questionHTML = `<p class='question'><strong>${currentTFQuestion + 1}- ${q.q}</strong></p>`;

        q.options.forEach((option, index) => {
    const letter = String.fromCharCode(97 + index); // "a", "b", ...
    questionHTML += `
        <label>
            <input type='radio' name='answer' value='${letter}'>
            ${option}
        </label><br>
    `;
});

        questionHTML += `<button class='btn' onclick='nextTFQuestion()'>Next</button>`;
        quizDiv.innerHTML = questionHTML;
    } else {
        // الانتهاء من عرض كل الأسئلة
        document.getElementById("passage").style.display = "none";
        quizDiv.innerHTML = "<p>You've finished all reading questions.</p>";
        loadQuestion(); // لو فيه مرحلة تانية
    }
}

    
  function nextTFQuestion() {
  const selectedAnswer = document.querySelector("input[name='answer']:checked");
  if (!selectedAnswer) {
    alert("Please select an answer");
    return;
  }

  const q = trueFalseQuestions[currentTFQuestion];
  const selectedValue = selectedAnswer.value;

  const isAnswerKeyALetter = q.a.length === 1 && ["a", "b", "c", "d"].includes(q.a.toLowerCase());

  if (isAnswerKeyALetter) {
    if (selectedValue === q.a.toLowerCase()) {
      tfCorrectAnswers++; // ✅ صحح هنا بدل score
    }
  } else {
    const selectedOptionIndex = selectedValue.charCodeAt(0) - 97;
    const selectedOptionText = q.options[selectedOptionIndex];

    if (selectedOptionText.trim().toLowerCase() === q.a.trim().toLowerCase()) {
      tfCorrectAnswers++; // ✅ صحح هنا بدل score
    }
  }

  currentTFQuestion++;
  loadTFQuestion();
}




        function loadQuestion() {
            let quizDiv = document.getElementById("quiz");
            let q = questions[currentQuestion];
            quizDiv.innerHTML = `<p class='question'>${q.q}</p>` +
                q.options.map((option, index) => `<label><input type='radio' name='answer' value='${String.fromCharCode(97 + index)}'> ${option}</label>`).join('') +
                `<button class='btn' onclick='nextQuestion()'>${currentQuestion === questions.length - 1 ? "Finish" : "Next"}</button>`;
        }
    
        function nextQuestion() {
            let selectedAnswer = document.querySelector("input[name='answer']:checked");
            if (!selectedAnswer) return;
            if (selectedAnswer.value === questions[currentQuestion].a) {
                correctAnswers++;
            }
            if (currentQuestion < questions.length - 1) {
                currentQuestion++;
                loadQuestion();
            } else {
                showResult();
            }
        }
    
let serverUrl = ""; // سيتم تحديثه تلقائيًا عند تحميل الصفحة

// دالة لجلب رابط السيرفر المخزن في GitHub
function fetchServerUrl() {
fetch("https://raw.githubusercontent.com/etiqotwf/liveServer1/main/serverUrl.json")
        .then(response => response.json())
        .then(data => {
            if (data.serverUrl) {
                serverUrl = data.serverUrl;
                console.log("✅ رابط السيرفر المحدث من GitHub:", serverUrl);
            } else {
                console.error("❌ لم يتم العثور على رابط السيرفر في المستودع.");
                retryFetchServerUrl();
            }
        })
        .catch(error => {
            console.error("❌ خطأ في جلب رابط السيرفر من GitHub:", error);
            retryFetchServerUrl();
        });
}

// دالة لإعادة المحاولة عند الفشل
function retryFetchServerUrl() {
    if (retryCount < MAX_RETRIES) {
        retryCount++;
        console.log(`🔄 إعادة المحاولة (${retryCount}/${MAX_RETRIES}) بعد 3 ثوانٍ...`);
        setTimeout(fetchServerUrl, 3000);
    } else {
        console.error("⛔ تم الوصول إلى الحد الأقصى من المحاولات، تعذر جلب رابط السيرفر.");
    }
}

// تحميل رابط السيرفر عند فتح الصفحة
fetchServerUrl();

function showResult() {
    clearInterval(timerInterval);

    let endTime = new Date();
    let timeTaken = Math.floor((endTime - startTime) / 1000);
    let minutesTaken = Math.floor(timeTaken / 60);
    let secondsTaken = timeTaken % 60;

    let name = document.getElementById("traineeName").value || "Unknown";
    let phone = document.getElementById("traineePhone").value || "Unknown";
    let date = new Date().toLocaleDateString("en-US");
    let course = document.getElementById("courseName").value || "Unknown";

    let totalQuestions = trueFalseQuestions.length + questions.length;
    let totalCorrectAnswers = tfCorrectAnswers + correctAnswers;

    let resultData = {
        name: name,
        phone: phone,
        date: date,
        course: course,
        startTime: startTime.toLocaleString("en-GB", {
            timeZone: "Africa/Cairo",
            year: "numeric",
            month: "long",
            day: "numeric",
            hour: "numeric",
            minute: "numeric",
            second: "numeric",
            hour12: true
        }),
        timeTaken: `${minutesTaken} min ${secondsTaken} sec`,
        score: `${totalCorrectAnswers} / ${totalQuestions}`
    };

    // إرسال البيانات إلى السيرفر إذا تم تحميل الرابط
    if (!serverUrl) {
        console.log("⏳ انتظار تحميل رابط السيرفر...");
        fetchServerUrl().then(() => {
            if (serverUrl) {
                sendDataToServer(resultData);
            } else {
                console.error("❌ لم يتم تحميل رابط السيرفر بعد.");
                alert("⚠️ تعذر إرسال البيانات! تأكد من اتصال الإنترنت وأعد المحاولة.");
            }
        });
    } else {
        sendDataToServer(resultData);
    }

    // إرسال البيانات إلى Google Sheets
    sendDataToGoogleSheet(resultData);

    // تحديث واجهة المستخدم
    document.getElementById("resultCourse").innerText = course;
    document.getElementById("resultName").innerText = name;
    document.getElementById("resultPhone").innerText = phone;
    document.getElementById("resultDate").innerText = date;
    document.getElementById("resultStartTime").innerText = startTime.toLocaleTimeString();
    document.getElementById("resultTime").innerText = `${minutesTaken} min ${secondsTaken} sec`;
    document.getElementById("resultScore").innerText = `${totalCorrectAnswers} / ${totalQuestions}`;

    document.getElementById("quizContainer").style.display = "none";
    document.getElementById("resultScreen").style.display = "block";
}

// إرسال البيانات إلى السيرفر الأساسي
function sendDataToServer(resultData) {
    fetch(`${serverUrl}/submit`, {
        method: "POST",
        headers: {
            "Content-Type": "application/json"
        },
        body: JSON.stringify(resultData)
    })
    .then(response => response.json())
    .then(data => console.log("✅ تم الإرسال إلى السيرفر بنجاح:", data))
    .catch(error => console.error("❌ خطأ أثناء الإرسال إلى السيرفر:", error));
}





function sendDataToGoogleSheet(resultData) {
    const formData = new URLSearchParams();
    formData.append("course", resultData.course);
    formData.append("name", resultData.name);
    formData.append("phone", resultData.phone);
    formData.append("date", resultData.date);
    formData.append("startTime", resultData.startTime);
    formData.append("timeTaken", resultData.timeTaken);
    formData.append("score", resultData.score);
    formData.append("course", resultData.course);


    fetch("https://script.google.com/macros/s/AKfycbybhyNx3uPAoAjGlvHe_jumSp_NKeOIIwoAPHWOqzUukmlmtoTlE5wF8Y_w17l5m9FS/exec", {
        method: "POST",
        headers: {
            "Content-Type": "application/x-www-form-urlencoded",
        },
        body: formData.toString(),
    })
    .then(response => response.text())
    .then(responseText => {
        console.log("✅ تم الإرسال إلى Google Sheet:", responseText);
    })
    .catch(error => {
        console.error("❌ خطأ في الإرسال إلى Google Sheet:", error);
    });
}




    </script>
    </body>
</html>
