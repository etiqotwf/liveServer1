<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<title>ุงุณุชุจูุงู ุงุญุชูุงุฌุงุช ุงูุชุฏุฑูุจ โ ูุฑูุฒ ุชุฏุฑูุจ</title>
<style>



/* ุนูู ุงูููุจุงููุ ุงุฌุนู ุงูุนููุฏ ุงูุฌุงูุจู ุนุงุฆู ูุฎูู ุงูุชุฑุงุถููุง */
@media (max-width: 768px) {

  /* ุฒุฑ ุงูุฅุญุตุงุก ุงูุนุงุฆู - ูุณุฎุฉ ุฃุณูู ูุฐูุจู */
  #toggleSide {
    position: fixed;
    bottom: 12px;
    right: 12px;
    width: 55px;
    height: 55px;
    border-radius: 50%;
    background: linear-gradient(145deg, #ffd700, #e6c200);
    border: 2px solid #fff4aa;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 28px;
    cursor: pointer;
    z-index: 1100;
    box-shadow: 0 6px 18px rgba(0,0,0,0.22);
    transition: 0.25s;
  }

  #toggleSide:hover {
    transform: scale(1.08);
    background: linear-gradient(145deg, #ffe76a, #e6c200);
  }



.side {
  /* โฆ ุจุงูู ููุฏู ููุง ูู โฆ */
  transform: translateX(0);  /* ูุธูุฑ ุงูุชุฑุงุถู */
}


  /* ุงููุงุฑุช ุงูุฌุงูุจู ููุณู - ุจุฏูู ุชุบููุฑ */
  .side {
    position: fixed;
    top: 65px;
    right: 10px;
    width: 290px;
    max-height: 80%;
    background: #fff;
    border-radius: 14px;
    box-shadow: 0 6px 20px rgba(0,0,0,0.22);
    padding: 10px;
    overflow-y: auto;
    z-index: 1000;
    transform: translateX(320px);
    transition: transform 0.35s cubic-bezier(.25,.8,.25,1);
  }

  .side.show {
    transform: translateX(0);
  }
}





  :root{
    --primary:#007bff;
    --accent:#00aaff;
    --card-bg:#ffffff;
    --muted:#666;
    --glass: rgba(255,255,255,0.85);
  }
  *{box-sizing:border-box;font-family: "Segoe UI", Tahoma, system-ui, Arial;}
  body{
    margin:0;
    background: linear-gradient(180deg,#f3f8ff 0%, #eef6ff 60%);
    color:#0b2436;
    padding:20px;
    min-height:100vh;
    display:flex;
    align-items:flex-start;
    justify-content:center;
  }
  .container {
  display: flex;          /* ูุถุน ุงููุญุชูู ุฌูุจ ุจุนุถ */
  gap: 20px;
  max-width: 1200px;
  margin: auto;
}

/* ุฌุงูุจ ุงูุฅุญุตุงุกุงุช + ุงูุตูุบ ุงูููุถูุฉ */
/* ุงูุนููุฏ ุงูุฌุงูุจู */
.side {
    width: 300px;
    height: 100vh;
    overflow-y: auto;   /* Scroll ููุนููุฏ */
    padding: 10px;
}

/* ูู ูุงุฑุช ุฏุงุฎู ุงูุฌุงูุจ */
.stat-card,
.tools-card {
    background: #fff;
    padding: 14px;
    border-radius: 10px;
    box-shadow: 0 6px 18px rgba(6,30,60,0.04);
    margin-bottom: 14px;

    max-height: 300px;   /* ุงุฑุชูุงุน ุงููุงุฑุช */
    overflow-y: auto;    /* Scroll ุฏุงุฎูู ููู ูุงุฑุช */
}

.level-card {
    background: #fff;
    padding: 14px;
    border-radius: 10px;
    box-shadow: 0 6px 18px rgba(6,30,60,0.04);
    margin-bottom: 14px;

    max-height: 250px;   /* ุงุฑุชูุงุน ุงููุงุฑุช */
    overflow-y: auto;    /* Scroll ุฏุงุฎูู */
}



/* ุงุณุชุจูุงู ูุฃุฎุฐ ุจุงูู ุงูุนุฑุถ */
form#surveyForm {
  flex: 1;
  background: linear-gradient(180deg, rgba(255,255,255,0.9), rgba(250,250,255,0.9));
  padding:16px;
  border-radius:10px;
  box-shadow: 0 6px 18px rgba(3,50,100,0.04);
  overflow-y: auto;
  max-height: 100vh;
}

  @media (max-width:980px){.container{grid-template-columns:1fr}}
  header{
    grid-column: 1 / -1;
    display:flex;
    gap:16px;
    align-items:center;
    margin-bottom:10px;
  }
  header img{
    width:84px;
    height:84px;
    object-fit:cover;
    border-radius:10px;
    box-shadow: 0 6px 18px rgba(0,0,0,0.08);
  }
  header h1{margin:0;font-size:20px;color:var(--primary);}
  header p{margin:0;color:var(--muted);font-size:14px}

  form{
    background: linear-gradient(180deg, rgba(255,255,255,0.9), rgba(250,250,255,0.9));
    padding:16px;
    border-radius:10px;
    box-shadow: 0 6px 18px rgba(3,50,100,0.04);
    display:flex;
    flex-direction:column;
    gap:12px;
  }
  label{font-weight:700;font-size:14px;margin-bottom:6px}
  .row{display:flex;gap:10px;flex-wrap:wrap}
  input[type="text"], select, textarea{
    width:100%;
    padding:10px 12px;
    border-radius:8px;
    border:1px solid #e0e6ef;
    outline:none;
    font-size:15px;
    background:#fff;
  }
  textarea{min-height:90px;resize:vertical}
  .small{font-size:13px;color:var(--muted)}
  .checkbox-grid{display:grid;grid-template-columns: repeat(2, 1fr);gap:8px}

  .chip{
    display:flex;
    align-items:center;
    gap:8px;
    padding:8px 10px;
    border-radius:10px;
    border:1px solid rgba(0,0,0,0.06);
    background:#fafcff;
    cursor:pointer;
    user-select:none;
    transition:0.15s;
  }
  .chip input{margin:0}
  .chip:hover{transform:translateY(-3px)}

  .actions{display:flex;gap:8px;flex-wrap:wrap;justify-content:flex-start}
  button{
    padding:10px 14px;
    border-radius:10px;
    border:none;
    cursor:pointer;
    font-weight:700;
    box-shadow: 0 6px 16px rgba(3,50,100,0.06);
    transition:0.2s;
  }
.btn-primary{
  background: linear-gradient(90deg,#ff7f50,#ff4500); /* ููู ุจุฑุชูุงูู ูุชุฏุฑุฌ */
  color: #fff;
  transition: 0.3s;
  opacity: 1;
  pointer-events: auto; /* ูุชููู ูุดุทุฉ */
}

/* ุญุงูุฉ ุบูุฑ ูุดุทุฉ */
.btn-primary.disabled {
  opacity: 0.5;
  pointer-events: none;
}
  .btn-ghost{background:transparent;border:1px solid #d6e6ff;color:var(--primary)}
  .btn-danger{background:#ff6b6b;color:#fff}

  .tab {overflow: hidden; border-bottom: 2px solid #ccc; margin-bottom: 10px;}
  .tab button {
    background-color: #f1f1f1;
    float: right;
    border: none;
    outline: none;
    cursor: pointer;
    padding: 10px 20px;
    transition: 0.3s;
    font-size: 16px;
  }
  .tab button:hover {background-color: #ddd;}
  .tab button.active {background-color: var(--primary); color: white;}
  .tabcontent {display: none; padding: 10px 0; border-top: none;}
  .tabcontent .chip{background:#eee;border-radius:25px;padding:10px 15px;margin:5px;}
  .tabcontent .chip input{margin-left:5px;}



  .stat{display:flex;gap:12px;align-items:center;margin-bottom:12px}
  .stat .big{font-size:24px;font-weight:800;color:var(--primary)}
  .stat .mut{color:var(--muted);font-size:13px}
  .chart-wrap{background:#f7fbff;border-radius:8px;padding:10px}
  .bar{height:10px;border-radius:6px;background:#d6ecff;margin:8px 0;overflow:hidden}
  .bar > i{display:block;height:100%;background:linear-gradient(90deg,var(--primary),var(--accent));width:0%}
  .table-mini{width:100%;border-collapse:collapse;font-size:14px;margin-top:8px}
  .table-mini td{padding:6px 4px;border-bottom:1px dashed #eee;color:#123}
  .tools{display:flex;gap:8px;flex-wrap:wrap;margin-top:10px}


/* ====== ุชุญุณูู ุงูุชูุงูู ูุน ุงูููุจุงูู ====== */

/* ุชุตุบูุฑ ุงูุญุงููุงุช ุงููุจูุฑุฉ ุนูู ุงูุดุงุดุงุช ุงูุตุบูุฑุฉ */
@media (max-width: 768px) {

  body {
    padding: 0;
    margin: 0;
    font-size: 15px;
  }

  .container {
    width: 100% !important;
    padding: 10px !important;
  }

  /* ุงููุฑูุช */
  .card, .tools-card, .stat-card {
    padding: 12px !important;
    margin-bottom: 12px;
  }

  /* ุงูุฌุฏูู */
  table {
    width: 100% !important;
    font-size: 14px !important;
  }
  th, td {
    padding: 6px !important;
  }

  /* ุงูุญููู */
  input, select, textarea {
    width: 100% !important;
    font-size: 15px !important;
  }

  /* ุงูุฃุฒุฑุงุฑ */
  button {
    width: 100%;
    margin-bottom: 10px;
  }

  .tools button {
    width: 100% !important;
    margin-bottom: 8px !important;
  }

  /* ุงูุชุจููุจุงุช */
  .tab button {
    width: 100%;
    padding: 12px;
    margin-bottom: 5px;
    font-size: 16px;
  }

  

}

/* ุดุงุดุงุช ุตุบูุฑุฉ ุฌุฏูุง */
@media (max-width: 480px) {
  body {
    font-size: 14px;
  }
  th, td {
    font-size: 13px;
  }
  button {
    font-size: 14px;
  }
}






</style>
</head>
<body>

<div class="container" role="main" aria-labelledby="pageTitle">

  <!-- ุงูุจุทุงูุฉ ุงูุฌุงูุจูุฉ ุนูู ุงููุณุงุฑ -->
 <!-- ุงูุจุทุงูุฉ ุงูุฌุงูุจูุฉ ุนูู ุงููุณุงุฑ -->
<aside class="side" aria-live="polite">

  <!-- ูุงุฑุช ุงูุฅุญุตุงุกุงุช -->
  <div class="stat-card">
    <div class="stat">
      <div class="big" id="totalCount">0</div>
      <div>
        <div class="mut">ุฅุฌูุงูู ุงูุงุณุชุฌุงุจุงุช</div>
        <div class="small">ุงูุฃุญุฏุซ ูุธูุฑ ุฃููุงู</div>
      </div>
    </div>

    <div style="margin-top:10px;">
      <strong>ุชูุฒูุน ุงูููุถูุนุงุช ุงููุทููุจุฉ</strong>
      <div class="chart-wrap" id="topicsChart"></div>
    </div>
  </div>

    <canvas id="myChart" style="width:100%; max-height:300px;"></canvas>

  


  <!-- ูุงุฑุช ุงูุตูุบ ุงูููุถูุฉ + ุฃุฒุฑุงุฑ -->
  <div class="tools-card">
    <div style="margin-bottom:10px;">
      <table class="table-mini" id="formatBreakdown"></table>
    </div>
    <div class="tools">
      <button id="exportCSV" class="btn-ghost"> ุชุตุฏูุฑ ุฅูู ุงูุฅูุณู</button>
      <button id="downloadJSON" class="btn-ghost">ุชุญููู JSON</button>
      <button id="copySummary" class="btn-ghost">ูุณุฎ ููุฎุต ููุญุงูุธุฉ</button>
    </div>
  </div>

</aside>

  <!-- ุงููููุฐุฌ ุนูู ุงููููู -->
  <form id="surveyForm" aria-label="ูููุฐุฌ ุงุณุชุจูุงู" 
        action="https://script.google.com/macros/s/AKfycbxQ9OSlGSdnDFXcrzQXanJkqEP4cXWVj5i-law9Co25RlH9Iww0kpf4OL4UPR2YFojJ/exec" method="POST" target="hidden_iframe">
    
    <input type="hidden" name="topics" id="topicsField">
    <input type="hidden" name="suggestions" id="suggestionsField">
    <input type="hidden" name="format" value="ุญุถูุฑู">
    
    <header>
      <img src="logo.jpg" alt="ููุฌู ูุฑูุฒ ุงูุชุฏุฑูุจ">
      <div>
        <h1 id="pageTitle">ุงุณุชุจูุงู ุงุญุชูุงุฌุงุช ุงูุชุฏุฑูุจ โ ูุฑูุฒ ุชุฏุฑูุจ ุงูุตุฑู</h1>
        <p class="small">ุณุงุนุฏูุง ุนูู ุชุตููู ุจุฑุงูุฌ ุชุฏุฑูุจูุฉ ุชูุงุฆู ุงุญุชูุงุฌุงุชู. ุงูุฅุฌุงุจุฉ ูุง ุชุณุชุบุฑู ุฃูุซุฑ ูู ุฏูููุฉ.</p>
      </div>
    </header>

    <div>
      <label for="name">ุงูุงุณู (ุงุฎุชูุงุฑู)</label>
      <input id="name" name="name" type="text" placeholder="ุงูุชุจ ุงุณูู ุฃู ุงุชุฑูู ูุงุฑุบุงู" />
    </div>

    <div>
      <label for="dept">ุงูุฅุฏุงุฑุฉ / ุงูุฌูุฉ</label>
      <input id="dept" name="dept" type="text" placeholder="ูุซุงู: ุฅุฏุงุฑุฉ ุงูุตุฑู/ ูุฑูุฒ ุชุฏุฑูุจ..." required />
    </div>

    <div>
      <label>ุงููุณุชูู ุงูุญุงูู ูู ููุงุฑุงุช ุงูุญุงุณูุจ</label>
      <div class="row">
        <select id="skillLevel" name="skill" aria-label="ูุณุชูู ุงูููุงุฑุฉ">
          <option value="ูุจุชุฏุฆ">ูุจุชุฏุฆ</option>
          <option value="ูุชูุณุท">ูุชูุณุท</option>
          <option value="ูุชูุฏู">ูุชูุฏู</option>
        </select>
      </div>
    </div>

<button id="toggleSide" type="button">๐</button>



 <!-- ุงูุชุจููุจุงุช -->
<div>
  <label>ุงูููุถูุนุงุช ุงูุชุฏุฑูุจูุฉ ุงููุทููุจุฉ (ุงุฎุชุฑ ูุง ููุงุณุจู)</label>

  <div class="tab">
  <button type="button" class="tablinks" onclick="openTab(event, 'civil')">๐๏ธ ุงูููุฏุณุฉ ุงููุฏููุฉ</button>
  <button type="button" class="tablinks" onclick="openTab(event, 'mechanical')">โ๏ธ ุงูููุฏุณุฉ ุงููููุงููููุฉ</button>
  <button type="button" class="tablinks" onclick="openTab(event, 'computer')">๐ฅ๏ธ ุงูููุจููุชุฑ</button>
  <button type="button" class="tablinks" onclick="openTab(event, 'administrative')">๐ข ุงูุฅุฏุงุฑูุฉ</button>
  <button type="button" class="tablinks" onclick="openTab(event, 'humanDevelopment')">๐ฑ ุงูุชูููุฉ ุงูุจุดุฑูุฉ</button>
  <button type="button" class="tablinks" onclick="openTab(event, 'future')">๐ก ุฏูุฑุงุช ููุชุฑุญุฉ ูู ุฌุงูุจ ุงููุฑูุฒ</button>
  <button type="button" class="tablinks" onclick="openTab(event, 'suggestions')">๐ ุงูุฏูุฑุงุช ุงูููุชุฑุญุฉ ูู ุฌุงูุจ ุงููุชุฏุฑุจูู</button>
</div>



  <!-- ๐๏ธ ุงูููุฏุณุฉ ุงููุฏููุฉ -->
  <div id="civil" class="tabcontent">
   <label class="chip"><input type="checkbox" value="ุชูููุฐ ุดุจูุช ุงูุตุฑู ูููุดุฑู ุงูููู"> ุชูููุฐ ุดุจูุช ุงูุตุฑู ูููุดุฑู ุงูููู</label>
<label class="chip"><input type="checkbox" value="ุงููุณุงุญุฉ ูุฅุณุชุฎุฏุงู ูุญุทุฉ ุงูุฑุตุฏ ุงูุดุงููุฉ (ูููุฏุณูู)"> ุงููุณุงุญุฉ ูุฅุณุชุฎุฏุงู ูุญุทุฉ ุงูุฑุตุฏ ุงูุดุงููุฉ (ูููุฏุณูู)</label>
<label class="chip"><input type="checkbox" value="ุตูุงูุฉ ุดุจูุงุช ุงูุตุฑู ูููููุฏุณูู"> ุตูุงูุฉ ุดุจูุงุช ุงูุตุฑู ูููููุฏุณูู</label>
<label class="chip"><input type="checkbox" value="ุชุดุบูู ูุฌููุนุฉ ุงูููุฒุฑ-ููุฒุงู ุงูููุฒุฑ ูููุดุฑู ุงูููู"> ุชุดุบูู ูุฌููุนุฉ ุงูููุฒุฑ-ููุฒุงู ุงูููุฒุฑ ูููุดุฑู ุงูููู</label>
<label class="chip"><input type="checkbox" value="ุชูููุฉ ุงููุฏุฑุงุช ุงูุฅุฏุงุฑูุฉ ูููููุฏุณูู"> ุชูููุฉ ุงููุฏุฑุงุช ุงูุฅุฏุงุฑูุฉ ูููููุฏุณูู</label>
<label class="chip"><input type="checkbox" value="ุชูููุฐ ุดุจูุงุช ุงูุตุฑู ูููููุฏุณูู"> ุชูููุฐ ุดุจูุงุช ุงูุตุฑู ูููููุฏุณูู</label>
<label class="chip"><input type="checkbox" value="ุงููุณุงุญุฉ ูุฅุณุชุฎุฏุงู ูุญุทุฉ ุงูุฑุตุฏ ุงูุดุงููุฉ (ูุณุงุญ-ูุดุฑู ููู)"> ุงููุณุงุญุฉ ูุฅุณุชุฎุฏุงู ูุญุทุฉ ุงูุฑุตุฏ ุงูุดุงููุฉ (ูุณุงุญ-ูุดุฑู ููู)</label>
<label class="chip"><input type="checkbox" value="ุฅุฑุดุงุฏ ุงูุตุฑู ูููููุฏุณูู"> ุฅุฑุดุงุฏ ุงูุตุฑู ูููููุฏุณูู</label>
<label class="chip"><input type="checkbox" value="ููุงุฑุงุช ุฅุนุฏุงุฏ ุงูุชูุงุฑูุฑ"> ููุงุฑุงุช ุฅุนุฏุงุฏ ุงูุชูุงุฑูุฑ</label>
<label class="chip"><input type="checkbox" value="ุชุดุบูู ูุฌููุนุฉ ุงูููุฒุฑ-ููุฒุงู ุงูููุฒุฑ ูููููุฏุณูู"> ุชุดุบูู ูุฌููุนุฉ ุงูููุฒุฑ-ููุฒุงู ุงูููุฒุฑ ูููููุฏุณูู</label>
<label class="chip"><input type="checkbox" value="ุชูููุฐ ููุดุฃุช ุงูุฑู ูุงูุตุฑู ูููููุฏุณูู"> ุชูููุฐ ููุดุฃุช ุงูุฑู ูุงูุตุฑู ูููููุฏุณูู</label>
<label class="chip"><input type="checkbox" value="ุฅุฑุดุงุฏ ุงูุตุฑู ููุฏุจูููุงุช"> ุฅุฑุดุงุฏ ุงูุตุฑู ููุฏุจูููุงุช</label>
<label class="chip"><input type="checkbox" value="ุฅุดุงุฏ ุงูุตุฑู ูููููุฏุณูู"> ุฅุดุงุฏ ุงูุตุฑู ูููููุฏุณูู</label>
<label class="chip"><input type="checkbox" value="ุฅุฏุงุฑุฉ ุงูุฃุฒูุงุช"> ุฅุฏุงุฑุฉ ุงูุฃุฒูุงุช</label>
  </div>


  <!-- โ๏ธ ุงูููุฏุณุฉ ุงููููุงููููุฉ -->
  <div id="mechanical" class="tabcontent">
   <label class="chip"><input type="checkbox" value="ุชุฏุฑูุจ ุชุญูููู ููุณุงุฆููู ูููุงุฏุฉ ุงูุญูุงุฑุงุช"> ุชุฏุฑูุจ ุชุญูููู ููุณุงุฆููู ูููุงุฏุฉ ุงูุญูุงุฑุงุช</label>
<label class="chip"><input type="checkbox" value="ุฃุณุงุณูุงุช ุงููุนุฏุงุช"> ุฃุณุงุณูุงุช ุงููุนุฏุงุช</label>
<label class="chip"><input type="checkbox" value="ูุนุฏุงุช ุตูุงูุฉ ุดุจูุงุช ุงูุตุฑู ุงููุบุทู (ูุงูููุฉ ุงูุบุณูู ูุงููุถุฎุงุช)"> ูุนุฏุงุช ุตูุงูุฉ ุดุจูุงุช ุงูุตุฑู ุงููุบุทู (ูุงูููุฉ ุงูุบุณูู ูุงููุถุฎุงุช)</label>
<label class="chip"><input type="checkbox" value="ุฃุณุงุณูุงุช ุงููุธุงู ุงูููุฏุฑููููู"> ุฃุณุงุณูุงุช ุงููุธุงู ุงูููุฏุฑููููู</label>
<label class="chip"><input type="checkbox" value="ุชูููุฉ ุงูููุงุฑุงุช ูู ุชุดุบูู ุงููุนุฏุงุช ูุงูุณูุงุฑุงุช ุงูุญููููุฉ"> ุชูููุฉ ุงูููุงุฑุงุช ูู ุชุดุบูู ุงููุนุฏุงุช ูุงูุณูุงุฑุงุช ุงูุญููููุฉ</label>
<label class="chip"><input type="checkbox" value="ุฃุณุงุณูุงุช ูุนูุฑุงุช ูุญุฑู ุงูุฏูุฒู"> ุฃุณุงุณูุงุช ูุนูุฑุงุช ูุญุฑู ุงูุฏูุฒู</label>
  </div>


  <!-- ๐ฅ๏ธ ุงูููุจููุชุฑ -->
  <div id="computer" class="tabcontent">
<label class="chip"><input type="checkbox" value="ุตูุงูุฉ ุงูุญุงุณุจ ุงูุขูู (ูุงุฑุฏููุฑ - ุณููุชููุฑ)"> ุตูุงูุฉ ุงูุญุงุณุจ ุงูุขูู (ูุงุฑุฏููุฑ - ุณููุชููุฑ)</label>
<label class="chip"><input type="checkbox" value="ADOBE ILLUSTRAITOR"> ADOBE ILLUSTRAITOR</label>
<label class="chip"><input type="checkbox" value="Arc GIS"> Arc GIS</label>
<label class="chip"><input type="checkbox" value="Windows"> Windows</label>
<label class="chip"><input type="checkbox" value="Google docs"> Google docs</label>
<label class="chip"><input type="checkbox" value="Word"> Word</label>
<label class="chip"><input type="checkbox" value="Power Point"> Power Point</label>
<label class="chip"><input type="checkbox" value="Excel"> Excel</label>
<label class="chip"><input type="checkbox" value="AutoCAD-2D"> AutoCAD-2D</label>
<label class="chip"><input type="checkbox" value="Sap"> Sap</label>
<label class="chip"><input type="checkbox" value="ููุชูุดูุจ"> ููุชูุดูุจ</label>
<label class="chip"><input type="checkbox" value="Access"> Access</label>
<label class="chip"><input type="checkbox" value="Primavera"> Primavera</label>
<label class="chip"><input type="checkbox" value="ุดุจูุงุช ุงูุญุงุณุจ ุงูุขูู"> ุดุจูุงุช ุงูุญุงุณุจ ุงูุขูู</label>
<label class="chip"><input type="checkbox" value="Revit for Civil ENG"> Revit for Civil ENG</label>
  </div>


  <!-- ๐ข ุงูุฅุฏุงุฑู -->
  <div id="administrative" class="tabcontent">
   <label class="chip"><input type="checkbox" value="ุฃุฎุตุงุฆู ุดุฆูู ุนุงูููู"> ุฃุฎุตุงุฆู ุดุฆูู ุนุงูููู</label>
<label class="chip"><input type="checkbox" value="ุฃููุงุก ูุฎุงุฒู"> ุฃููุงุก ูุฎุงุฒู</label>
<label class="chip"><input type="checkbox" value="ุงููุนุงุดุงุช ูุงูููุงููู ุงูููุธูุฉ ููุง"> ุงููุนุงุดุงุช ูุงูููุงููู ุงูููุธูุฉ ููุง</label>
<label class="chip"><input type="checkbox" value="ููุฏูุจู ุงูุญุฌุฒ ุงูุฅุฏุงุฑู"> ููุฏูุจู ุงูุญุฌุฒ ุงูุฅุฏุงุฑู</label>
<label class="chip"><input type="checkbox" value="ุฅุฌุฑุงุกุงุช ุชุฑุงุฎูุต ุงูุฑู ูุงูุตุฑู"> ุฅุฌุฑุงุกุงุช ุชุฑุงุฎูุต ุงูุฑู ูุงูุตุฑู</label>
<label class="chip"><input type="checkbox" value="ุนููุฏ ูููุงููุงุช ุงูุฃุนูุงู ูุงูุชูุฑูุฏุงุช (ูุงููู 182)"> ุนููุฏ ูููุงููุงุช ุงูุฃุนูุงู ูุงูุชูุฑูุฏุงุช (ูุงููู 182)</label>
<label class="chip"><input type="checkbox" value="ูุฑูู ุงูุฃุณุนุงุฑ"> ูุฑูู ุงูุฃุณุนุงุฑ</label>
<label class="chip"><input type="checkbox" value="ุฃุฎุตุงุฆู ุดุฆูู ูุงููุฉ"> ุฃุฎุตุงุฆู ุดุฆูู ูุงููุฉ</label>
  </div>


  <!-- ๐ฑ ุงูุชูููุฉ ุงูุจุดุฑูุฉ -->
  <div id="humanDevelopment" class="tabcontent">
    <label class="chip"><input type="checkbox" value="ููุงุฑุงุช ุงูุชูุงุตู ูุงูุงุชุตุงู"> ููุงุฑุงุช ุงูุชูุงุตู ูุงูุงุชุตุงู</label>
    <label class="chip"><input type="checkbox" value="ุญู ุงููุดููุงุช ูุงุชุฎุงุฐ ุงููุฑุงุฑ"> ุญู ุงููุดููุงุช ูุงุชุฎุงุฐ ุงููุฑุงุฑ</label>
    <label class="chip"><input type="checkbox" value="ุงูุนูู ุงูุฌูุงุนู ูุงูููุงุฏุฉ"> ุงูุนูู ุงูุฌูุงุนู ูุงูููุงุฏุฉ</label>
    <label class="chip"><input type="checkbox" value="ุฅุฏุงุฑุฉ ุงูุถุบูุท"> ุฅุฏุงุฑุฉ ุงูุถุบูุท</label>
    <label class="chip"><input type="checkbox" value="ุงูุชูููุฑ ุงูุฅุจุฏุงุนู"> ุงูุชูููุฑ ุงูุฅุจุฏุงุนู</label>
    <label class="chip"><input type="checkbox" value="ุฅุฏุงุฑุฉ ุงูููุช ุงูุดุฎุตู"> ุฅุฏุงุฑุฉ ุงูููุช ุงูุดุฎุตู</label>
    <label class="chip"><input type="checkbox" value="ุงูุชูุงุฒู ุจูู ุงูุนูู ูุงูุญูุงุฉ"> ุงูุชูุงุฒู ุจูู ุงูุนูู ูุงูุญูุงุฉ</label>
    <label class="chip"><input type="checkbox" value="ูู ุงูุฅููุงุน ูุงูุชุฃุซูุฑ"> ูู ุงูุฅููุงุน ูุงูุชุฃุซูุฑ</label>
    <label class="chip"><input type="checkbox" value="ููุงุฑุงุช ุงูุนุฑุถ ูุงูุฅููุงุก"> ููุงุฑุงุช ุงูุนุฑุถ ูุงูุฅููุงุก</label>
  </div>


  <!-- ๐ก ุฏูุฑุงุช ุฌุฏูุฏุฉ -->
  <div id="future" class="tabcontent">
    <label class="chip"><input type="checkbox" value="ุจุฑูุฌุฉ ุชุทุจููุงุช ุงูููุจ"> ุจุฑูุฌุฉ ุชุทุจููุงุช ุงูููุจ</label>
    <label class="chip"><input type="checkbox" value="JavaScript ูุชูุฏู"> JavaScript ูุชูุฏู</label>
    <label class="chip"><input type="checkbox" value="ุงูุฐูุงุก ุงูุงุตุทูุงุนู ูู ุงูุฃูู ุงูุณูุจุฑุงูู"> ุงูุฐูุงุก ุงูุงุตุทูุงุนู ูู ุงูุฃูู ุงูุณูุจุฑุงูู</label>
    <label class="chip"><input type="checkbox" value="ุฃุฑุดูุฉ ุงููููุงุช ุจุงูุฐูุงุก ุงูุงุตุทูุงุนู"> ุฃุฑุดูุฉ ุงููููุงุช ุจุงูุฐูุงุก ุงูุงุตุทูุงุนู</label>
    <label class="chip"><input type="checkbox" value="ุชุญููู ุงูุจูุงูุงุช ุจุงุณุชุฎุฏุงู ุงูุฐูุงุก ุงูุงุตุทูุงุนู"> ุชุญููู ุงูุจูุงูุงุช ุจุงุณุชุฎุฏุงู ุงูุฐูุงุก ุงูุงุตุทูุงุนู</label>
    <label class="chip"><input type="checkbox" value="ููุฏูุฉ ูู ุชุนูู ุงูุขูุฉ"> ููุฏูุฉ ูู ุชุนูู ุงูุขูุฉ</label>
  </div>


  <!-- ๐ ุงูุฏูุฑุงุช ุงูููุชุฑุญุฉ -->
  <div id="suggestions" class="tabcontent">
    <label for="suggestedCourses">ุงูุชุจ ุฃู ุฏูุฑุงุช ุชุฏุฑูุจูุฉ ุชุฑุบุจ ุจูุง:</label>
    <textarea id="suggestedCourses" placeholder="ูุซุงู: ุฏูุฑุฉ ูุชูุฏูุฉ ูู ุชุญููู ุงูุจูุงูุงุช..." rows="6"></textarea>
  </div>

</div>

    <div class="actions">
<button type="button" class="btn-primary" id="submitBtn">ุฅุฑุณุงู + ุญูุธ</button>
      <button class="btn-ghost" id="previewBtn" type="button">ูุนุงููุฉ ุงูุฅุญุตุงุก ุงูุขู</button>
    </div>

  </form>

</div>

<iframe name="hidden_iframe" style="display:none;"></iframe>


<script>
  // ุนูุฏ ุงูุถุบุท ุนูู ุฃู ููุงู ูู ุงูุตูุญุฉุ ุฃุฏุฎู ูุถุน ููุก ุงูุดุงุดุฉ
  document.addEventListener("click", () => {
    const elem = document.documentElement; // ุฃู document.getElementById("myForm")
    if (document.fullscreenElement) return; // ูุง ุชูุนู ุดูุก ุฅุฐุง ููุง ุจุงููุนู ูู ููุก ุงูุดุงุดุฉ

    if (elem.requestFullscreen) {
      elem.requestFullscreen();
    } else if (elem.webkitRequestFullscreen) { /* Safari */
      elem.webkitRequestFullscreen();
    } else if (elem.msRequestFullscreen) { /* IE11 */
      elem.msRequestFullscreen();
    }
  });
</script>

<script>
// ุงูุชุจููุจุงุช
function openTab(evt, tabName){
  const tabcontent=document.getElementsByClassName("tabcontent");
  const tablinks=document.getElementsByClassName("tablinks");
  for(let i=0;i<tabcontent.length;i++) tabcontent[i].style.display="none";
  for(let i=0;i<tablinks.length;i++) tablinks[i].className=tablinks[i].className.replace(" active","");
  document.getElementById(tabName).style.display="block";
  evt.currentTarget.className+=" active";
}

// ุฌูุน ุงูุจูุงูุงุช ูู ุงูููุฑู
function collectForm(){
  const name=document.getElementById('name').value.trim();
  const dept=document.getElementById('dept').value.trim();
  const skill=document.getElementById('skillLevel').value;
  const checked=Array.from(document.querySelectorAll('.tabcontent input[type="checkbox"]:checked')).map(i=>i.value);
  const suggestions=document.getElementById('suggestedCourses')?document.getElementById('suggestedCourses').value.split('\n').map(s=>s.trim()).filter(s=>s!==''): [];
  const topics=[...checked,...suggestions];
  return {id:Date.now(),name,dept,skill,topics,format:"ุญุถูุฑู",ts:new Date().toISOString()};
}

function validate(entry){if(!entry.dept){alert('ูู ูุถูู ุงูุชุจ ุงุณู ุงูุฅุฏุงุฑุฉ ุฃู ุงูุฌูุฉ.'); return false;} return true;}

// Fetch ุงูุจูุงูุงุช ูู Google Sheet
const SHEET_URL = 'https://script.google.com/macros/s/AKfycbxQ9OSlGSdnDFXcrzQXanJkqEP4cXWVj5i-law9Co25RlH9Iww0kpf4OL4UPR2YFojJ/exec';
async function fetchData(){
  try{
    const res = await fetch(SHEET_URL);
    const data = await res.json();
    renderStats(data.reverse()); // ุงูุฃุญุฏุซ ุฃููุงู
  }catch(e){console.error("ูุดู ูู ุฌูุจ ุงูุจูุงูุงุช ูู Google Sheet:", e);}
}

// ุนุฑุถ ุงูุฅุญุตุงุกุงุช
function renderStats(data){
  if(!data) data=[];
  document.getElementById('totalCount').textContent=data.length;

  const topicsMap={},formats={},levels={};
  data.forEach(r=>{
    (r["๐ ุงูููุงุถูุน"]||"").split(',').forEach(t=>topicsMap[t.trim()] = (topicsMap[t.trim()]||0)+1);
    formats[r["๐ฆ ุดูู ุงููุดุงุฑูุฉ"]]=(formats[r["๐ฆ ุดูู ุงููุดุงุฑูุฉ"]]||0)+1;
    levels[r["๐ผ ุงูููุงุฑุฉ"]]=(levels[r["๐ผ ุงูููุงุฑุฉ"]]||0)+1;
  });

  // ุงูููุถูุนุงุช
  const topicsChart=document.getElementById('topicsChart'); topicsChart.innerHTML='';
  const totalTopics=Object.values(topicsMap).reduce((a,b)=>a+b,0);
  Object.entries(topicsMap).forEach(([topic,count])=>{
    const percent=totalTopics?Math.round((count/totalTopics)*100):0;
    const bar=document.createElement('div'); bar.className='bar'; bar.innerHTML=`<i style="width:${percent}%"></i>`;
    const label=document.createElement('div'); label.textContent=`${topic} โ ${count} (${percent}%)`;
    topicsChart.appendChild(label); topicsChart.appendChild(bar);
  });

  // ุงูุตูุบ
  
  // ุงููุณุชููุงุช
  const levelBreakdown=document.getElementById('levelBreakdown'); levelBreakdown.innerHTML='';
  Object.entries(levels).forEach(([lvl,count])=>levelBreakdown.innerHTML+=`<tr><td>${lvl}</td><td>${count}</td></tr>`);
}

// ุฃุฒุฑุงุฑ ุงูุชุญููู ูุงูุชุตุฏูุฑ
document.getElementById('previewBtn').addEventListener('click',fetchData);
document.getElementById('exportCSV').addEventListener('click', async () => {
  const res = await fetch(SHEET_URL);
  const data = await res.json();

  if (!data.length) {
    alert('ูุง ุชูุฌุฏ ุจูุงูุงุช ููุชุตุฏูุฑ');
    return;
  }

  // โฆ ุฅุถุงูุฉ BOM ูุฅุตูุงุญ ูุดููุฉ ุงูุฑููุฒ ุงูุบุฑูุจุฉ ูู Excel
  const csv = ['\uFEFF๐งโ๐ ุงูุงุณู,๐ข ุงูุฅุฏุงุฑุฉ,๐ ุงููุณุชูู,๐ ุงูููุถูุนุงุช,๐ ุงูุตูุบุฉ,๐ ุงูุชุงุฑูุฎ'];

  // ุงูุตููู
  data.forEach(r => csv.push(
    `"${r["๐งโ๐ ุงูุงุณู"]}","${r["๐ข ุงูุฅุฏุงุฑุฉ"]}","${r["๐ผ ุงูููุงุฑุฉ"]}","${r["๐ ุงูููุงุถูุน"]}","${r["๐ฆ ุดูู ุงููุดุงุฑูุฉ"]}","${r["๐ ุงูุชุงุฑูุฎ"]}"`
  ));

  // ุฅูุดุงุก ููู CSV ุจุชุฑููุฒ UTF-8 ุงูุตุญูุญ
  const blob = new Blob([csv.join('\n')], { type: 'text/csv;charset=utf-8;' });
  const url = URL.createObjectURL(blob);

  const a = document.createElement('a');
  a.href = url;
  a.download = 'training_responses.csv';
  a.click();

  URL.revokeObjectURL(url);
});

document.getElementById('downloadJSON').addEventListener('click',async ()=>{
  const res = await fetch(SHEET_URL);
  const data = await res.json();
  if(!data.length){alert('ูุง ุชูุฌุฏ ุจูุงูุงุช ููุชุญููู'); return;}
  const blob=new Blob([JSON.stringify(data,null,2)],{type:'application/json'}); const url=URL.createObjectURL(blob);
  const a=document.createElement('a'); a.href=url; a.download='training_responses.json'; a.click(); URL.revokeObjectURL(url);
});
document.getElementById('copySummary').addEventListener('click',async ()=>{
  const res = await fetch(SHEET_URL);
  const data = await res.json();
  const lines=['ููุฎุต ุงุญุชูุงุฌุงุช ุงูุชุฏุฑูุจ โ ูุฑูุฒ ุชุฏุฑูุจ ุบุฑุจ ุงูุฏูุชุง','ุฅุฌูุงูู ุงูุงุณุชุฌุงุจุงุช: '+data.length];
  if(data.length){
    const topics={}; const formats={};
    data.forEach(r=>{(r["๐ ุงูููุงุถูุน"]||"").split(',').forEach(t=>topics[t]=(topics[t]||0)+1); formats[r["๐ฆ ุดูู ุงููุดุงุฑูุฉ"]] = (formats[r["๐ฆ ุดูู ุงููุดุงุฑูุฉ"]]||0)+1;});
    lines.push(''); lines.push('ุฃูุซุฑ ุงูููุถูุนุงุช ุทูุจุงู:');
    Object.entries(topics).sort((a,b)=>b[1]-a[1]).slice(0,6).forEach(([k,v])=>lines.push(`- ${k}: ${v}`));
    lines.push(''); lines.push('ุชูุงุตูู ุตูุบ ุงูุชุฏุฑูุจ:');
    Object.entries(formats).forEach(([k,v])=>lines.push(`- ${k}: ${v}`));
  }
  navigator.clipboard.writeText(lines.join('\n')); alert('ุชู ูุณุฎ ุงูููุฎุต ููุญุงูุธุฉ');
});

// ุนูุฏ ุงูุฅุฑุณุงูุ ุชุญุฏูุซ ุงูุญููู ุงููุฎููุฉ ููููุฑู
document.getElementById('submitBtn').addEventListener('click', function(e){
  e.preventDefault(); // ูููุน ุฅุนุงุฏุฉ ุชุญููู ุงูุตูุญุฉ
  const submitBtn = document.querySelector('.btn-primary');
  submitBtn.classList.add('disabled'); // ุชุนุทูู ุงูุฒุฑ ูุจู ุงูุฅุฑุณุงู
  submitBtn.textContent = "ุฌุงุฑู ุงูุฅุฑุณุงู..."; // ุชุบููุฑ ุงููุต ูุคูุชูุง

  const entry = collectForm();
  if(!validate(entry)) {
    submitBtn.classList.remove('disabled');
    submitBtn.textContent = "ุฅุฑุณุงู + ุญูุธ";
    return;
  }

  const checked = Array.from(document.querySelectorAll('.tabcontent input[type="checkbox"]:checked')).map(i => i.value);
  const suggestions = document.getElementById('suggestedCourses') 
                      ? document.getElementById('suggestedCourses').value.split('\n').map(s => s.trim()).filter(s => s !== '') 
                      : [];
  document.getElementById('topicsField').value = [...checked, ...suggestions].join(', ');
  document.getElementById('suggestionsField').value = suggestions.join(',');

  fetch("https://script.google.com/macros/s/AKfycbxQ9OSlGSdnDFXcrzQXanJkqEP4cXWVj5i-law9Co25RlH9Iww0kpf4OL4UPR2YFojJ/exec", {
    method: 'POST',
    body: new FormData(document.getElementById('surveyForm'))
  })
  .then(res => res.json())
  .then(data => {
    if(data.status === "success") {
      document.getElementById('surveyForm').reset();
      fetchData(); // ุชุญุฏูุซ ุงูุฅุญุตุงุกุงุช

      // ุฅุบูุงู ุฃู ุชุจููุจ ููุชูุญ ุจุนุฏ ุงูุฅุฑุณุงู
      const tabcontent = document.getElementsByClassName("tabcontent");
      for (let i = 0; i < tabcontent.length; i++) {
        tabcontent[i].style.display = "none";
      }
      const tablinks = document.getElementsByClassName("tablinks");
      for (let i = 0; i < tablinks.length; i++) {
        tablinks[i].classList.remove("active");
      }

    } else {
      alert(data.message || "โ ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุงูุญูุธ");
    }
  })
  .catch(err => alert("โ ุญุฏุซ ุฎุทุฃ ูู ุงูุงุชุตุงู: " + err))
  .finally(() => {
    submitBtn.classList.remove('disabled'); // ุฅุนุงุฏุฉ ุชูุนูู ุงูุฒุฑ
    submitBtn.textContent = "ุฅุฑุณุงู + ุญูุธ";

    
    // ุฅุนุงุฏุฉ ุงูุตูุญุฉ ูุฃุนูู ุจุนุฏ ุงูุฅุฑุณุงู
    window.scrollTo({ top: 0, behavior: 'smooth' });

  });
});


// ุชุญููู ุงูุจูุงูุงุช ุนูุฏ ูุชุญ ุงูุตูุญุฉ
fetchData();


function drawChart(totalCount, levelCounts) {

  const ctx = document.getElementById('myChart').getContext('2d');

  new Chart(ctx, {
    type: 'bar',
    data: {
      labels: ['ูุจุชุฏุฆ', 'ูุชูุณุท', 'ูุชูุฏู'],
      datasets: [{
        label: 'ุนุฏุฏ ุงููุชุฏุฑุจูู',
        data: [
          levelCounts.beginner,
          levelCounts.intermediate,
          levelCounts.advanced
        ],
        borderWidth: 2
      }]
    },
    options: {
      responsive: true,
      scales: {
        y: { beginAtZero: true }
      }
    }
  });
}


</script>


<script>
document.addEventListener("DOMContentLoaded", async () => {
  const ctx = document.getElementById("myChart").getContext("2d");

  try {
    // ุฌูุจ ุงูุจูุงูุงุช ูู ุฌูุฌู ุดูุช
    const res = await fetch(SHEET_URL);
    const rows = await res.json();

    if (!rows.length) {
      console.warn("ูุง ุชูุฌุฏ ุจูุงูุงุช ูุนุฑุถ ุงูุฑุณู ุงูุจูุงูู");
      return;
    }

    // ุญุณุงุจ ุนุฏุฏ ูู ุฅุฏุงุฑุฉ
    const counts = {};
    rows.forEach(r => {
      const dept = r["๐ข ุงูุฅุฏุงุฑุฉ"] || "ุบูุฑ ูุญุฏุฏ";
      if (!counts[dept]) counts[dept] = 0;
      counts[dept]++;
    });

    const labels = Object.keys(counts);
    const values = Object.values(counts);

    // ุฅูุดุงุก ุชุฏุฑุฌ ูููู ููุฎุท ูุงูุฎูููุฉ
    const gradient = ctx.createLinearGradient(0, 0, 0, 400);
    gradient.addColorStop(0, "rgba(0, 123, 255, 0.6)");
    gradient.addColorStop(1, "rgba(0, 123, 255, 0.1)");

    new Chart(ctx, {
      type: "line",
      data: {
        labels: labels,
        datasets: [{
          label: "ุนุฏุฏ ุงูุทูุจุงุช ููู ุฅุฏุงุฑุฉ",
          data: values,
          borderColor: "#007bff",      // ููู ุงูุฎุท
          backgroundColor: gradient,   // ููู ุฎูููุฉ ุงูุฎุท ุจุงูุชุฏุฑุฌ
          fill: true,                  // ูุชูููู ุงูููุทูุฉ ุชุญุช ุงูุฎุท
          tension: 0.4,                // ูุฌุนู ุงูุฎุท ููุญูู ูุณูุณ
          pointBackgroundColor: "#fff",// ููู ููุงุท ุงูุจูุงูุงุช
          pointBorderColor: "#007bff", // ุญุฏูุฏ ุงูููุงุท
          pointRadius: 6,              // ุญุฌู ุงูููุงุท
          pointHoverRadius: 8          // ุญุฌู ุงูููุงุท ุนูุฏ ุงููุฑูุฑ ุนูููุง
        }]
      },
      options: {
        responsive: true,
        plugins: {
          legend: {
            display: true,
            labels: {
              color: "#333",
              font: { size: 14, weight: "bold" }
            }
          },
          tooltip: {
            enabled: true,
            backgroundColor: "#007bff",
            titleColor: "#fff",
            bodyColor: "#fff",
            mode: "index",
            intersect: false
          }
        },
        scales: {
          y: {
            beginAtZero: true,
            grid: {
              color: "rgba(0,0,0,0.05)"
            }
          },
          x: {
            grid: {
              color: "rgba(0,0,0,0.05)"
            }
          }
        }
      }
    });

  } catch (e) {
    console.error("ุฎุทุฃ ูู ูุฑุงุกุฉ ุงูุจูุงูุงุช ูู ุงูุดูุช:", e);
  }
});



  const toggleBtn = document.getElementById('toggleSide');
  const side = document.querySelector('.side');

  toggleBtn.addEventListener('click', () => {
    side.classList.toggle('show');
  });



  

</script>



</body>
</html>
