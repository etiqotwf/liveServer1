<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Ø§Ø³ØªØ¨ÙŠØ§Ù† Ø§Ø­ØªÙŠØ§Ø¬Ø§Øª Ø§Ù„ØªØ¯Ø±ÙŠØ¨ â€” Ù…Ø±ÙƒØ² ØªØ¯Ø±ÙŠØ¨</title>
<style>
  :root{
    --primary:#007bff;
    --accent:#00aaff;
    --card-bg:#ffffff;
    --muted:#666;
    --glass: rgba(255,255,255,0.85);
  }
  *{box-sizing:border-box;font-family: "Segoe UI", Tahoma, system-ui, Arial;}
  body{
    margin:0;
    background: linear-gradient(180deg,#f3f8ff 0%, #eef6ff 60%);
    color:#0b2436;
    padding:20px;
    min-height:100vh;
    display:flex;
    align-items:flex-start;
    justify-content:center;
  }
  .container{
    max-width:980px;
    width:100%;
    display:grid;
    grid-template-columns: 300px 1fr;
    gap:20px;
  }
  @media (max-width:980px){.container{grid-template-columns:1fr}}
  header{
    grid-column: 1 / -1;
    display:flex;
    gap:16px;
    align-items:center;
    margin-bottom:10px;
  }
  header img{
    width:84px;
    height:84px;
    object-fit:cover;
    border-radius:10px;
    box-shadow: 0 6px 18px rgba(0,0,0,0.08);
  }
  header h1{margin:0;font-size:20px;color:var(--primary);}
  header p{margin:0;color:var(--muted);font-size:14px}

  form{
    background: linear-gradient(180deg, rgba(255,255,255,0.9), rgba(250,250,255,0.9));
    padding:16px;
    border-radius:10px;
    box-shadow: 0 6px 18px rgba(3,50,100,0.04);
    display:flex;
    flex-direction:column;
    gap:12px;
  }
  label{font-weight:700;font-size:14px;margin-bottom:6px}
  .row{display:flex;gap:10px;flex-wrap:wrap}
  input[type="text"], select, textarea{
    width:100%;
    padding:10px 12px;
    border-radius:8px;
    border:1px solid #e0e6ef;
    outline:none;
    font-size:15px;
    background:#fff;
  }
  textarea{min-height:90px;resize:vertical}
  .small{font-size:13px;color:var(--muted)}
  .checkbox-grid{display:grid;grid-template-columns: repeat(2, 1fr);gap:8px}

  .chip{
    display:flex;
    align-items:center;
    gap:8px;
    padding:8px 10px;
    border-radius:10px;
    border:1px solid rgba(0,0,0,0.06);
    background:#fafcff;
    cursor:pointer;
    user-select:none;
    transition:0.15s;
  }
  .chip input{margin:0}
  .chip:hover{transform:translateY(-3px)}

  .actions{display:flex;gap:8px;flex-wrap:wrap;justify-content:flex-start}
  button{
    padding:10px 14px;
    border-radius:10px;
    border:none;
    cursor:pointer;
    font-weight:700;
    box-shadow: 0 6px 16px rgba(3,50,100,0.06);
    transition:0.2s;
  }
  .btn-primary{background:linear-gradient(90deg,var(--primary),var(--accent)); color:#fff}
  .btn-ghost{background:transparent;border:1px solid #d6e6ff;color:var(--primary)}
  .btn-danger{background:#ff6b6b;color:#fff}

  .tab {overflow: hidden; border-bottom: 2px solid #ccc; margin-bottom: 10px;}
  .tab button {
    background-color: #f1f1f1;
    float: right;
    border: none;
    outline: none;
    cursor: pointer;
    padding: 10px 20px;
    transition: 0.3s;
    font-size: 16px;
  }
  .tab button:hover {background-color: #ddd;}
  .tab button.active {background-color: var(--primary); color: white;}
  .tabcontent {display: none; padding: 10px 0; border-top: none;}
  .tabcontent .chip{background:#eee;border-radius:25px;padding:10px 15px;margin:5px;}
  .tabcontent .chip input{margin-left:5px;}

  .side{
    padding:14px;
    border-radius:10px;
    background:linear-gradient(180deg,#ffffff,#fbfeff);
    box-shadow: 0 6px 18px rgba(6,30,60,0.04);
  }
  .stat{display:flex;gap:12px;align-items:center;margin-bottom:12px}
  .stat .big{font-size:24px;font-weight:800;color:var(--primary)}
  .stat .mut{color:var(--muted);font-size:13px}
  .chart-wrap{background:#f7fbff;border-radius:8px;padding:10px}
  .bar{height:10px;border-radius:6px;background:#d6ecff;margin:8px 0;overflow:hidden}
  .bar > i{display:block;height:100%;background:linear-gradient(90deg,var(--primary),var(--accent));width:0%}
  .table-mini{width:100%;border-collapse:collapse;font-size:14px;margin-top:8px}
  .table-mini td{padding:6px 4px;border-bottom:1px dashed #eee;color:#123}
  .tools{display:flex;gap:8px;flex-wrap:wrap;margin-top:10px}
</style>
</head>
<body>

<div class="container" role="main" aria-labelledby="pageTitle">

  <!-- Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠØ© Ø¹Ù„Ù‰ Ø§Ù„ÙŠØ³Ø§Ø± -->
  <aside class="side" aria-live="polite">
    <div class="stat">
      <div class="big" id="totalCount">0</div>
      <div>
        <div class="mut">Ø¥Ø¬Ù…Ø§Ù„Ù‰ Ø§Ù„Ø§Ø³ØªØ¬Ø§Ø¨Ø§Øª</div>
        <div class="small">Ø§Ù„Ø£Ø­Ø¯Ø« ÙŠØ¸Ù‡Ø± Ø£ÙˆÙ„Ø§Ù‹</div>
      </div>
    </div>

    <div>
      <strong>ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ù…ÙˆØ¶ÙˆØ¹Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©</strong>
      <div class="chart-wrap" id="topicsChart"></div>
    </div>

    <div style="margin-top:10px;">
      <strong>Ø§Ù„ØµÙŠØº Ø§Ù„Ù…ÙØ¶Ù„Ø©</strong>
      <table class="table-mini" id="formatBreakdown"></table>
    </div>

    <div style="margin-top:10px;">
      <strong>Ø§Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø­Ø§Ù„ÙŠ (ØªÙ„Ø®ÙŠØµ)</strong>
      <table class="table-mini" id="levelBreakdown"></table>
    </div>

    <div class="tools">
      <button id="exportCSV" class="btn-ghost">ØªØµØ¯ÙŠØ± CSV</button>
      <button id="downloadJSON" class="btn-ghost">ØªØ­Ù…ÙŠÙ„ JSON</button>
      <button id="copySummary" class="btn-ghost">Ù†Ø³Ø® Ù…Ù„Ø®Øµ Ù„Ù„Ø­Ø§ÙØ¸Ø©</button>
    </div>
  </aside>

  <!-- Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ Ø¹Ù„Ù‰ Ø§Ù„ÙŠÙ…ÙŠÙ† -->
  <form id="surveyForm" aria-label="Ù†Ù…ÙˆØ°Ø¬ Ø§Ø³ØªØ¨ÙŠØ§Ù†">
    <header>
      <img src="logo.jpg" alt="Ù„ÙˆØ¬Ùˆ Ù…Ø±ÙƒØ² Ø§Ù„ØªØ¯Ø±ÙŠØ¨">
      <div>
        <h1 id="pageTitle">Ø§Ø³ØªØ¨ÙŠØ§Ù† Ø§Ø­ØªÙŠØ§Ø¬Ø§Øª Ø§Ù„ØªØ¯Ø±ÙŠØ¨ â€” Ù…Ø±ÙƒØ² ØªØ¯Ø±ÙŠØ¨ Ø§Ù„ØµØ±Ù</h1>
        <p class="small">Ø³Ø§Ø¹Ø¯Ù†Ø§ Ø¹Ù„Ù‰ ØªØµÙ…ÙŠÙ… Ø¨Ø±Ø§Ù…Ø¬ ØªØ¯Ø±ÙŠØ¨ÙŠØ© ØªÙ„Ø§Ø¦Ù… Ø§Ø­ØªÙŠØ§Ø¬Ø§ØªÙƒ. Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ù„Ø§ ØªØ³ØªØºØ±Ù‚ Ø£ÙƒØ«Ø± Ù…Ù† Ø¯Ù‚ÙŠÙ‚Ø©.</p>
      </div>
    </header>

    <div>
      <label for="name">Ø§Ù„Ø§Ø³Ù… (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</label>
      <input id="name" type="text" placeholder="Ø§ÙƒØªØ¨ Ø§Ø³Ù…Ùƒ Ø£Ùˆ Ø§ØªØ±ÙƒÙ‡ ÙØ§Ø±ØºØ§Ù‹" />
    </div>

    <div>
      <label for="dept">Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© / Ø§Ù„Ø¬Ù‡Ø©</label>
      <input id="dept" type="text" placeholder="Ù…Ø«Ø§Ù„: Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØµØ±Ù/ Ù…Ø±ÙƒØ² ØªØ¯Ø±ÙŠØ¨..." required />
    </div>

    <div>
      <label>Ø§Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø­Ø§Ù„ÙŠ ÙÙŠ Ù…Ù‡Ø§Ø±Ø§Øª Ø§Ù„Ø­Ø§Ø³ÙˆØ¨</label>
      <div class="row">
        <select id="skillLevel" aria-label="Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ù…Ù‡Ø§Ø±Ø©">
          <option value="Ù…Ø¨ØªØ¯Ø¦">Ù…Ø¨ØªØ¯Ø¦</option>
          <option value="Ù…ØªÙˆØ³Ø·">Ù…ØªÙˆØ³Ø·</option>
          <option value="Ù…ØªÙ‚Ø¯Ù…">Ù…ØªÙ‚Ø¯Ù…</option>
          <option value="Ù„Ø§ Ø§Ø¹Ø±Ù">Ù„Ø§ Ø£Ø¹Ø±Ù</option>
        </select>
      </div>
    </div>

    <!-- Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª -->
    <div>
      <label>Ø§Ù„Ù…ÙˆØ¶ÙˆØ¹Ø§Øª Ø§Ù„ØªØ¯Ø±ÙŠØ¨ÙŠØ© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© (Ø§Ø®ØªØ± Ù…Ø§ ÙŠÙ†Ø§Ø³Ø¨Ùƒ)</label>
      <div class="tab">
        <button type="button" class="tablinks" onclick="openTab(event, 'civil')">ğŸ—ï¸ Ø§Ù„Ù‡Ù†Ø¯Ø³Ø© Ø§Ù„Ù…Ø¯Ù†ÙŠØ©</button>
        <button type="button" class="tablinks" onclick="openTab(event, 'mechanical')">âš™ï¸ Ø§Ù„Ù‡Ù†Ø¯Ø³Ø© Ø§Ù„Ù…ÙŠÙƒØ§Ù†ÙŠÙƒÙŠØ©</button>
        <button type="button" class="tablinks" onclick="openTab(event, 'computer')">ğŸ–¥ï¸ Ø§Ù„ÙƒÙ…Ø¨ÙŠÙˆØªØ±</button>
        <button type="button" class="tablinks" onclick="openTab(event, 'administrative')">ğŸ¢ Ø§Ù„Ø¥Ø¯Ø§Ø±ÙŠØ©</button>
        <button type="button" class="tablinks" onclick="openTab(event, 'humanDevelopment')">ğŸŒ± Ø§Ù„ØªÙ†Ù…ÙŠØ© Ø§Ù„Ø¨Ø´Ø±ÙŠØ©</button>
        <button type="button" class="tablinks" onclick="openTab(event, 'future')">ğŸ’¡ Ø¯ÙˆØ±Ø§Øª Ø¬Ø¯ÙŠØ¯Ù‡</button>
        <button type="button" class="tablinks" onclick="openTab(event, 'suggestions')">ğŸ“ Ø§Ù„Ø¯ÙˆØ±Ø§Øª Ø§Ù„Ù…Ù‚ØªØ±Ø­Ø© Ù…Ù† Ù‚Ø¨Ù„ Ø§Ù„Ù…ØªØ¯Ø±Ø¨ÙŠÙ†</button>
      </div>

      <!-- Ù…Ø­ØªÙˆÙ‰ Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª -->
      <!-- Ù…Ø«Ø§Ù„: Ù‚Ø³Ù… Ø§Ù„ÙƒÙ…Ø¨ÙŠÙˆØªØ± -->
      <div id="computer" class="tabcontent">
        <label class="chip"><input type="checkbox" value="ØµÙŠØ§Ù†Ø© Ø§Ù„Ø­Ø§Ø³Ø¨ Ø§Ù„Ø¢Ù„ÙŠ (Ù‡Ø§Ø±Ø¯ÙˆÙŠØ± - Ø³ÙˆÙØªÙˆÙŠØ±)"> ØµÙŠØ§Ù†Ø© Ø§Ù„Ø­Ø§Ø³Ø¨ Ø§Ù„Ø¢Ù„ÙŠ (Ù‡Ø§Ø±Ø¯ÙˆÙŠØ± - Ø³ÙˆÙØªÙˆÙŠØ±)</label>
        <label class="chip"><input type="checkbox" value="ADOBE ILLUSTRAITOR"> ADOBE ILLUSTRAITOR</label>
        <label class="chip"><input type="checkbox" value="Arc GIS"> Arc GIS</label>
        <label class="chip"><input type="checkbox" value="Windows"> Windows</label>
        <label class="chip"><input type="checkbox" value="Google docs"> Google docs</label>
        <label class="chip"><input type="checkbox" value="Word"> Word</label>
        <label class="chip"><input type="checkbox" value="Power Point"> Power Point</label>
        <label class="chip"><input type="checkbox" value="Excel"> Excel</label>
        <label class="chip"><input type="checkbox" value="AutoCAD-2D"> AutoCAD-2D</label>
        <label class="chip"><input type="checkbox" value="Sap"> Sap</label>
        <label class="chip"><input type="checkbox" value="ÙÙˆØªÙˆØ´ÙˆØ¨"> ÙÙˆØªÙˆØ´ÙˆØ¨</label>
        <label class="chip"><input type="checkbox" value="Access"> Access</label>
        <label class="chip"><input type="checkbox" value="Primavera"> Primavera</label>
        <label class="chip"><input type="checkbox" value="Ø´Ø¨ÙƒØ§Øª Ø§Ù„Ø­Ø§Ø³Ø¨ Ø§Ù„Ø¢Ù„ÙŠ"> Ø´Ø¨ÙƒØ§Øª Ø§Ù„Ø­Ø§Ø³Ø¨ Ø§Ù„Ø¢Ù„ÙŠ</label>
        <label class="chip"><input type="checkbox" value="Revit for Civil ENG"> Revit for Civil ENG</label>
      </div>

      <!-- Ø¨Ø§Ù‚ÙŠ Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª Ù…Ø´Ø§Ø¨Ù‡Ø© -->
      <!-- ... civil, mechanical, administrative, humanDevelopment, future, suggestions -->

      <div id="suggestions" class="tabcontent">
        <label for="suggestedCourses">Ø§ÙƒØªØ¨ Ø£ÙŠ Ø¯ÙˆØ±Ø§Øª ØªØ¯Ø±ÙŠØ¨ÙŠØ© ØªØ±ØºØ¨ Ø¨Ù‡Ø§:</label>
        <textarea id="suggestedCourses" placeholder="Ù…Ø«Ø§Ù„: Ø¯ÙˆØ±Ø© Ù…ØªÙ‚Ø¯Ù…Ø© ÙÙŠ ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§ØªØŒ Ø¯ÙˆØ±Ø© ÙÙŠ Ø±ÙˆØ¨ÙˆØªØ§Øª Ø°ÙƒÙŠØ©..." rows="6"></textarea>
      </div>
    </div>

    <div class="actions">
      <button class="btn-primary" id="submitBtn" type="button">Ø¥Ø±Ø³Ø§Ù„ + Ø­ÙØ¸</button>
      <button class="btn-ghost" id="previewBtn" type="button">Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„Ø¥Ø­ØµØ§Ø¡ Ø§Ù„Ø¢Ù†</button>
      <button class="btn-danger" id="clearBtn" type="button" title="Ø­Ø°Ù ÙƒÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª">Ù…Ø³Ø­ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</button>
    </div>

    <div class="small" style="margin-top:6px;color:var(--muted)">
      Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ØªÙØ®Ø²Ù† ÙÙ‚Ø· ÙÙŠ Ø¬Ù‡Ø§Ø²Ùƒ (LocalStorage). ÙŠÙ…ÙƒÙ†Ùƒ ØªØµØ¯ÙŠØ±Ù‡Ø§ ÙˆÙ…Ø´Ø§Ø±ÙƒØªÙ‡Ø§ Ù…Ø¹ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©.
    </div>

  </form>
</div>

<script>
// Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª
function openTab(evt, tabName){
  const tabcontent=document.getElementsByClassName("tabcontent");
  const tablinks=document.getElementsByClassName("tablinks");
  for(let i=0;i<tabcontent.length;i++) tabcontent[i].style.display="none";
  for(let i=0;i<tablinks.length;i++) tablinks[i].className=tablinks[i].className.replace(" active","");
  document.getElementById(tabName).style.display="block";
  evt.currentTarget.className+=" active";
}
document.getElementsByClassName('tablinks')[0].click();

// LocalStorage
const STORAGE_KEY = 'trainingResponses_v1';
function loadResponses(){ return JSON.parse(localStorage.getItem(STORAGE_KEY) || "[]"); }
function saveResponses(arr){ localStorage.setItem(STORAGE_KEY, JSON.stringify(arr)); }

// Ø¬Ù…Ø¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ø§Ù„ÙÙˆØ±Ù…
function collectForm(){
  const name=document.getElementById('name').value.trim();
  const dept=document.getElementById('dept').value.trim();
  const skill=document.getElementById('skillLevel').value;
  const checked=Array.from(document.querySelectorAll('.tabcontent input[type="checkbox"]:checked')).map(i=>i.value);
  const suggestions=document.getElementById('suggestedCourses').value.split('\n').map(s=>s.trim()).filter(s=>s!=='');
  const topics=[...checked,...suggestions];
  return {id:Date.now(),name,dept,skill,topics,format:"Ø­Ø¶ÙˆØ±ÙŠ",ts:new Date().toISOString()};
}

function resetForm(){document.getElementById('surveyForm').reset();}
function validate(entry){if(!entry.dept){alert('Ù…Ù† ÙØ¶Ù„Ùƒ Ø§ÙƒØªØ¨ Ø§Ø³Ù… Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø£Ùˆ Ø§Ù„Ø¬Ù‡Ø©.'); return false;} return true;}

// Ø¹Ø±Ø¶ Ø§Ù„Ø¥Ø­ØµØ§Ø¡Ø§Øª
function renderStats(){
  const data=loadResponses();
  document.getElementById('totalCount').textContent=data.length;

  const topicsMap={},formats={},levels={};
  data.forEach(r=>{(r.topics||[]).forEach(t=>topicsMap[t]=(topicsMap[t]||0)+1); formats[r.format]=(formats[r.format]||0)+1; levels[r.skill]=(levels[r.skill]||0)+1;});

  // Ø§Ù„Ù…ÙˆØ¶ÙˆØ¹Ø§Øª
  const topicsChart=document.getElementById('topicsChart');
  topicsChart.innerHTML='';
  const totalTopics=Object.values(topicsMap).reduce((a,b)=>a+b,0);
  Object.entries(topicsMap).forEach(([topic,count])=>{
    const percent=totalTopics?Math.round((count/totalTopics)*100):0;
    const bar=document.createElement('div'); bar.className='bar'; bar.innerHTML=`<i style="width:${percent}%"></i>`;
    const label=document.createElement('div'); label.textContent=`${topic} â€” ${count} (${percent}%)`;
    topicsChart.appendChild(label); topicsChart.appendChild(bar);
  });

  // Ø§Ù„ØµÙŠØº
  const formatBreakdown=document.getElementById('formatBreakdown'); formatBreakdown.innerHTML='';
  Object.entries(formats).forEach(([fmt,count])=>formatBreakdown.innerHTML+=`<tr><td>${fmt}</td><td>${count}</td></tr>`);

  // Ø§Ù„Ù…Ø³ØªÙˆÙŠØ§Øª
  const levelBreakdown=document.getElementById('levelBreakdown'); levelBreakdown.innerHTML='';
  Object.entries(levels).forEach(([lvl,count])=>levelBreakdown.innerHTML+=`<tr><td>${lvl}</td><td>${count}</td></tr>`);
}

function buildSummaryText(){
  const data=loadResponses();
  const lines=[]; lines.push('Ù…Ù„Ø®Øµ Ø§Ø­ØªÙŠØ§Ø¬Ø§Øª Ø§Ù„ØªØ¯Ø±ÙŠØ¨ â€” Ù…Ø±ÙƒØ² ØªØ¯Ø±ÙŠØ¨ ØºØ±Ø¨ Ø§Ù„Ø¯Ù„ØªØ§'); lines.push('Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø§Ø³ØªØ¬Ø§Ø¨Ø§Øª: '+data.length);
  if(data.length){
    const topics={},formats={};
    data.forEach(r=>{(r.topics||[]).forEach(t=>topics[t]=(topics[t]||0)+1); formats[r.format]=(formats[r.format]||0)+1;});
    lines.push(''); lines.push('Ø£ÙƒØ«Ø± Ø§Ù„Ù…ÙˆØ¶ÙˆØ¹Ø§Øª Ø·Ù„Ø¨Ø§Ù‹:');
    Object.entries(topics).sort((a,b)=>b[1]-a[1]).slice(0,6).forEach(([k,v])=>lines.push(`- ${k}: ${v}`));
    lines.push(''); lines.push('ØªÙØ§ØµÙŠÙ„ ØµÙŠØº Ø§Ù„ØªØ¯Ø±ÙŠØ¨:');
    Object.entries(formats).forEach(([k,v])=>lines.push(`- ${k}: ${v}`));
  }
  return lines.join('\n');
}

// ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù„ÙØ§Øª
function downloadText(text,filename,mime){
  const blob=new Blob([text],{type:mime});
  const url=URL.createObjectURL(blob);
  const a=document.createElement('a');
  a.href=url;a.download=filename;document.body.appendChild(a);a.click();
  setTimeout(()=>{URL.revokeObjectURL(url);a.remove();},500);
}

// ğŸŒŸ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¥Ù„Ù‰ Google Sheet
const GOOGLE_SHEET_WEBAPP_URL = "https://script.google.com/macros/s/AKfycbxAi1wrrPlXptVBnZuO8IKtQpyBxEz8FCDx_eEtAsEhyA7Dz1W-WFs57JgTiiiGJjCl/exec"; // Ø¶Ø¹ Ù‡Ù†Ø§ Ø±Ø§Ø¨Ø· Ø§Ù„Ù€ Web App

async function sendDataToGoogleSheet(entry){
  try{
    const res = await fetch(GOOGLE_SHEET_WEBAPP_URL, {
      method: "POST",
      headers: {"Content-Type":"application/json"},
      body: JSON.stringify(entry)
    });
    const json = await res.json();
    return json;
  }catch(err){
    console.error("Error sending to Google Sheet:", err);
    return {status:"error", message: err.message};
  }
}

document.getElementById('submitBtn').addEventListener('click', async function(){
  const entry = collectForm();
  if(!validate(entry)) return;

  const result = await sendDataToGoogleSheet(entry);

  if(result.status==="success"){
    saveResponses([entry,...loadResponses()]);
    renderStats();
    alert(result.message);
    resetForm();
  } else if(result.status==="duplicate"){
    alert(result.message);
  } else {
    saveResponses([entry,...loadResponses()]);
    renderStats();
    alert("âš ï¸ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ Ø¥Ù„Ù‰ Google SheetØŒ ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø­Ù„ÙŠØ§Ù‹.\n"+result.message);
  }
});

</script>
</body>
</html>
