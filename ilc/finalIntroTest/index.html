<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Reading Comprehension Quiz</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      text-align: center;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-start;
      margin: 0;
      background: #1e1e2e;
      color: white;
    }

    .container {
      margin-top: 5px;
      width: 95%;
      max-width: 1200px;
      background: #282a36;
      padding: 10px 30px 30px;
      border-radius: 10px;
      box-shadow: 0px 0px 15px rgba(0, 0, 0, 0.5);
      text-align: left;
    }

    h1, h2, p { margin-top: 0; }

    .question {
      font-weight: bold;
      font-size: 30px;
      margin-bottom: 20px;
    }

    .options label {
      display: block;
      padding: 10px;
    }

    .btn {
      background: #ff5555;
      color: white;
      border: none;
      padding: 12px 25px;
      cursor: pointer;
      border-radius: 5px;
      margin-top: 200px;
      font-size: 18px;
      display: block;
    }

    .btn:hover { background: #ff79c6; }

    .result-screen {
      display: none;
      background: #44475a;
      padding: 30px;
      border-radius: 10px;
      text-align: center;
      width: 100%;
    }

    #resultScore {
      font-size: 36px;
      font-weight: bold;
      color: #ffffff;
      margin-top: 20px;
    }

    .result-screen p {
      font-size: 20px;
      font-weight: bold;
      color: #f8f8f2;
    }

    #timer {
  font-size: 28px;
  color: #222; /* لون غامق عشان يظهر فوق الخلفية البيضاء */
  font-weight: bold;
  background: rgba(255, 215, 0, 0.2); /* خلفية شفافة ذهبية خفيفة */
  padding: 10px 20px;
  border-radius: 10px;
  width: fit-content;
  margin: 20px auto;
  position: relative;
  z-index: 2;
  box-shadow: 0 0 10px rgba(0,0,0,0.1);
}


    .author {
      font-size: 30px;
      color: #eb2d0b;
      text-align: center;
      font-weight: bold;
      margin-bottom: 15px;
    }

    label {
      font-size: 22px;
      padding: 10px;
      display: block;
    }

    input[type="radio"] {
      transform: scale(1.5);
      margin-right: 10px;
    }

    #passage { font-size: 16px; font-weight: bold; }

    #startScreen p {
      font-size: 22px;
      font-weight: bold;
    }

    #startScreen input {
      font-size: 20px;
      font-weight: bold;
      padding: 8px;
    }

    #startScreen h1 {
      font-size: 40px;
      font-weight: bold;
      color: #ffd700;
      text-align: center;
      margin-bottom: 20px;
    }

    /* شاشة الأسئلة البيضاء */
    #quizContainer {
      display: none;
      position: relative;
      background: #ffffff;
      color: #000;
      border-radius: 25px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.2);
      padding: 40px;
      max-width: 1000px;
      text-align: left;
      overflow: hidden;
    }

    

    /* اللوجو الشفاف في المنتصف */
    #quizContainer::before {
      content: "";
      position: absolute;
      inset: 0;
      background: url('ilc.jpg') center center no-repeat;
      background-size: 60%;
      opacity: 0.2;
      z-index: 0;
    }

    #quizContainer > * { position: relative; z-index: 1; }

    @keyframes fall {
      to { transform: translateY(110vh); opacity: 0.5; }
    }
  </style>
</head>

<body>

  <!-- شاشة البداية -->
  <div class="container" id="startScreen" style="
    max-width: 700px; 
    margin: 60px auto; 
    padding: 40px; 
    background: #ffffff; 
    border-radius: 25px; 
    box-shadow: 0 10px 30px rgba(0,0,0,0.2); 
    text-align: center; 
    font-family: 'Trebuchet MS', sans-serif;
    position: relative;
    overflow: hidden;
  ">
    <h1 style="color:#0056b3; font-size: 40px; margin-bottom: 20px;">
      🤖 The British International Learning Center (ILC)
    </h1>
    <h2 style="font-size: 26px; color:#444; margin-bottom: 30px;">✨ AI-Powered Training Portal ✨</h2>

    <p style="font-size: 20px;">
      📘 Course Name: 
      <input type="text" id="courseName" value="Final Intro Test" readonly 
        style="font-size:25px; padding:12px; width:60%; border:none; border-radius:8px; background:#f0f0f0; text-align:center;">
    </p>

    <p style="font-size: 20px;">
      👤 Enter Your Name: 
      <input type="text" id="traineeName" placeholder="Type your name..." 
        style="font-size:18px; padding:12px; width:60%; border:1px solid #ccc; border-radius:8px; text-align:center;">
    </p>

    <p style="font-size: 20px;">
      📱 Enter Your Phone Number: 
      <input type="text" id="traineePhone" placeholder="Type your phone number..." 
        style="font-size:18px; padding:12px; width:60%; border:1px solid #ccc; border-radius:8px; text-align:center;">
    </p>

    <p style="font-size: 20px;">
      🔑 Enter Password: 
      <input type="password" id="password" placeholder="Enter password..." 
        style="font-size:18px; padding:12px; width:60%; border:1px solid #ccc; border-radius:8px; text-align:center;">
    </p>

    <button class="btn" onclick="startQuiz()" style="
      margin-top: 25px; 
      font-size: 22px; 
      padding: 15px 40px; 
      border:none; 
      border-radius:12px; 
      background: linear-gradient(135deg, #007bff, #00d4ff); 
      color:white; 
      cursor:pointer; 
      box-shadow:0 8px 20px rgba(0,0,0,0.2); 
      transition: transform 0.2s;
    " onmouseover="this.style.transform='scale(1.1)'" 
       onmouseout="this.style.transform='scale(1)'">
      🚀 Start Quiz
    </button>

    <p style="margin-top: 40px; font-size: 18px; color: gray;">
      ✍️ Edited by: Ahmed Amer
    </p>


    

    <div id="emojiRain" style="
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      font-size: 2rem;
    "></div>
  </div>

  <!-- شاشة الأسئلة -->
  <div class="container" id="quizContainer">
    <h2 id="quizTitle">Placement Test</h2>
    <p class="author">📘 The British International Learning Center (ILC)</p>
    <p>Date: <span id="date"></span></p>
     <!-- Emoji Sticky Animation -->
 <div id="emoji-character" style="
    position: sticky;
    top: 10px;
    float: right;
    margin-left: auto;
    display: block;
    z-index: 10;
">
  <img src="ilc.jpg" alt="ILC Logo" style="
      width: 180px;
      height: auto;
      border-radius: 12px;
      box-shadow: 0 0 12px rgba(0,0,0,0.3);
  ">
</div>

    <p id="timer"> ----- </p>
    <div id="passage">
      <h3>Read the following passage carefully and answer the following questions:</h3>
      <p style="font-size: 22px;"></p>
    </div>
    <div id="quiz"></div>

  
  </div>


  
  <!-- شاشة النتيجة -->
  <div class="result-screen" id="resultScreen">
    <h2>Test Result</h2>
    <p class="author">Created by: Ahmed Amer</p>
    <p><strong>Course Name:</strong> <span id="resultCourse"></span></p>
    <p><strong>Name:</strong> <span id="resultName"></span></p>
    <p><strong>Phone Number:</strong> <span id="resultPhone"></span></p>
    <p><strong>Test Date:</strong> <span id="resultDate"></span></p>
    <p><strong>Start Time:</strong> <span id="resultStartTime"></span></p>
    <p><strong>Time Taken:</strong> <span id="resultTime"></span></p>
    <p><strong>Score:</strong> <span id="resultScore"></span></p>
  </div>

  <script>
    // إيموجي المطر فقط في الشاشة الافتتاحية
    const emojis = ["📝","✏️","📘","📖","⏳","🎯","🏆","📊","👨‍🎓"];
    const container = document.getElementById("emojiRain");
    let rainInterval;

    function createEmoji() {
      const emoji = document.createElement("div");
      emoji.innerText = emojis[Math.floor(Math.random() * emojis.length)];
      emoji.style.position = "absolute";
      emoji.style.left = Math.random() * 100 + "vw";
      emoji.style.top = "-50px";
      emoji.style.fontSize = "28px";
      emoji.style.animation = `fall ${6 + Math.random() * 3}s linear`;
      container.appendChild(emoji);
      setTimeout(() => emoji.remove(), 2000);
    }

    function startEmojiRain() {
      rainInterval = setInterval(createEmoji, 500);
    }

    function stopEmojiRain() {
      clearInterval(rainInterval);
      container.innerHTML = "";
    }

    startEmojiRain();

    function startQuiz() {
      document.getElementById("startScreen").style.display = "none";
      document.getElementById("quizContainer").style.display = "block";
      stopEmojiRain();
    }
  </script>


  


<script>
    // عند الضغط على أي مكان في الصفحة، أدخل وضع ملء الشاشة
    document.addEventListener("click", () => {
      const elem = document.documentElement; // أو document.getElementById("myForm")
      if (document.fullscreenElement) return; // لا تفعل شيء إذا كنا بالفعل في ملء الشاشة

      if (elem.requestFullscreen) {
        elem.requestFullscreen();
      } else if (elem.webkitRequestFullscreen) { /* Safari */
        elem.webkitRequestFullscreen();
      } else if (elem.msRequestFullscreen) { /* IE11 */
        elem.msRequestFullscreen();
      }
    });
  </script>

    
   <script>
        document.getElementById("date").innerText = new Date().toLocaleDateString("en-US");
    
  const trueFalseQuestions = [
  {
    passage: `Unusual Homes<br>
Shusaku Arakawa and Madeline Gins are famous designers. Their nine lofts near Tokyo, Japan, are very colorful. The apartments are blue, pink, red, yellow, and other bright colors. Inside, the walls are colourful, too. The floors go up and down, and some rooms are round. The windows have strange shapes, so there are no curtains. There are small doors to the outside. Inside, there aren't any closets. The bookcase is in the middle of the living room.
Dan Philips likes to help people. He builds houses for artists and other low-income people in Huntville, Texas, in the United States. One house, the "tree house", is in a large tree in the forest. It has windows on the floor! It also has a small kitchen. The bed is on the upstairs floor. There is a wood-burning stove from an old ship in the living room. Philips teaches people how to build houses with recycled materials.`,
    q: " There are -------------------",
    a: "a",
    options: ["Colorful walls", "Closets", "Bookcase", "Windows on the floor"]
  },
  {
    passage: `Unusual Homes<br>
Shusaku Arakawa and Madeline Gins are famous designers. Their nine lofts near Tokyo, Japan, are very colorful. The apartments are blue, pink, red, yellow, and other bright colors. Inside, the walls are colourful, too. The floors go up and down, and some rooms are round. The windows have strange shapes, so there are no curtains. There are small doors to the outside. Inside, there aren't any closets. The bookcase is in the middle of the living room.
Dan Philips likes to help people. He builds houses for artists and other low-income people in Huntville, Texas, in the United States. One house, the "tree house", is in a large tree in the forest. It has windows on the floor! It also has a small kitchen. The bed is on the upstairs floor. There is a wood-burning stove from an old ship in the living room. Philips teaches people how to build houses with recycled materials.`,
    q: " There aren't any -----------------------------",
    a: "b",
    options: ["Colorful walls", "Closets", "Bookcase", "Windows on the floor"]
  },
  {
    passage: `Unusual Homes<br>
Shusaku Arakawa and Madeline Gins are famous designers. Their nine lofts near Tokyo, Japan, are very colorful. The apartments are blue, pink, red, yellow, and other bright colors. Inside, the walls are colourful, too. The floors go up and down, and some rooms are round. The windows have strange shapes, so there are no curtains. There are small doors to the outside. Inside, there aren't any closets. The bookcase is in the middle of the living room.
Dan Philips likes to help people. He builds houses for artists and other low-income people in Huntville, Texas, in the United States. One house, the "tree house", is in a large tree in the forest. It has windows on the floor! It also has a small kitchen. The bed is on the upstairs floor. There is a wood-burning stove from an old ship in the living room. Philips teaches people how to build houses with recycled materials.`,
    q: " There is a ----------------------------------in the middle of the living room",
    a: "c",
    options: ["Colorful walls", "Closets", "Bookcase", "Windows on the floor"]
  },
  {
    passage: `Unusual Homes<br>
Shusaku Arakawa and Madeline Gins are famous designers. Their nine lofts near Tokyo, Japan, are very colorful. The apartments are blue, pink, red, yellow, and other bright colors. Inside, the walls are colourful, too. The floors go up and down, and some rooms are round. The windows have strange shapes, so there are no curtains. There are small doors to the outside. Inside, there aren't any closets. The bookcase is in the middle of the living room.
Dan Philips likes to help people. He builds houses for artists and other low-income people in Huntville, Texas, in the United States. One house, the "tree house", is in a large tree in the forest. It has windows on the floor! It also has a small kitchen. The bed is on the upstairs floor. There is a wood-burning stove from an old ship in the living room. Philips teaches people how to build houses with recycled materials.`,
    q: " There are ------------------------------------",
    a: "d",
    options: ["Colorful walls", "Closets", "Bookcase", "Windows on the floor"]
  },
  {
    passage: `Unusual Homes<br>
Shusaku Arakawa and Madeline Gins are famous designers. Their nine lofts near Tokyo, Japan, are very colorful. The apartments are blue, pink, red, yellow, and other bright colors. Inside, the walls are colourful, too. The floors go up and down, and some rooms are round. The windows have strange shapes, so there are no curtains. There are small doors to the outside. Inside, there aren't any closets. The bookcase is in the middle of the living room.
Dan Philips likes to help people. He builds houses for artists and other low-income people in Huntville, Texas, in the United States. One house, the "tree house", is in a large tree in the forest. It has windows on the floor! It also has a small kitchen. The bed is on the upstairs floor. There is a wood-burning stove from an old ship in the living room. Philips teaches people how to build houses with recycled materials.`,
    q: " There is a -----------------------------------",
    a: "c",
    options: ["Colorful walls", "Closets", "Wood-burning stove", "Bed on the upstairs floor"]
  },
  {
    passage: `Unusual Homes<br>
Shusaku Arakawa and Madeline Gins are famous designers. Their nine lofts near Tokyo, Japan, are very colorful. The apartments are blue, pink, red, yellow, and other bright colors. Inside, the walls are colourful, too. The floors go up and down, and some rooms are round. The windows have strange shapes, so there are no curtains. There are small doors to the outside. Inside, there aren't any closets. The bookcase is in the middle of the living room.
Dan Philips likes to help people. He builds houses for artists and other low-income people in Huntville, Texas, in the United States. One house, the "tree house", is in a large tree in the forest. It has windows on the floor! It also has a small kitchen. The bed is on the upstairs floor. There is a wood-burning stove from an old ship in the living room. Philips teaches people how to build houses with recycled materials.`,
    q: " There is a -----------------------------------",
    a: "d",
    options: ["Colorful walls", "Closets", "Bookcase", "Bed on the upstairs floor"]
  }
];

const questions = [
  {
    q: "7- Hello. What's --------------------name?",
    a: "c",
    options: ["hers", "she", "your", "yours"]
  },
  {
    q: "8- Nice to meet you, ---------------",
    a: "c",
    options: ["to", "two", "too", "that"]
  },
  {
    q: "9- My name ----------Anwar Ahmed.",
    a: "b",
    options: ["are", "is", "were", "am"]
  },
  {
    q: "10- -----------is my real friend Jennifer Miller.",
    a: "c",
    options: ["These", "Those", "This", "They"]
  },
  {
    q: "11- Jennifer and Michael are ------------------a list of classmates' phone numbers.",
    a: "b",
    options: ["doing", "making", "putting", "sitting"]
  },
  {
    q: "12- That is -------------------English book.",
    a: "d", // Wood-burning / تعديل حسب نموذج المدرس
    options: ["the", "a", "an", "no article"]
  },
  {
    q: "13- Whose jacket is this? Is it ------------------------, Phil?",
    a: "c",
    options: ["your", "my", "yours", "her"]
  },
  {
    q: "14- Do you -------------------public transportation?",
    a: "c", // تعديل حسب المدرس
    options: ["uses", "use", "used", "using"]
  },
  {
    q: "15- We have our meals in the -------------------room.",
    a: "b",
    options: ["living", "bed", "dining", "bath"]
  },
  {
    q: "16- A: My name is Pam Walker. B: --------------------------------------------",
    a: "c",
    options: ["It's Williams", "I'm Jake Williams", "Not at all", "Nothing"]
  },
  {
    q: "17- A: --------------------. Are you Soo-mi Kim? B: Yes, I am.",
    a: "a",
    options: ["Excuse me", "Thank you", "You are welcome", "Never mind"]
  },
  {
    q: "18- A: Is your first language English? B: --------------------------------------",
    a: "c",
    options: ["No, it's Japan", "No, it is Japanese", "No, it's Italy", "For what"]
  },
  {
    q: "19- A: What's Marrakech like? B: ------------------------------------------",
    a: "c",
    options: ["It's in Morocco", "It's very interesting", "It's my city", "It's naked"]
  },
  {
    q: "20- Are these ----------------jeans? No, they are hers.",
    a: "b",
    options: ["your", "yours", "its", "ours"]
  },
  {
    q: "21- In the winter, the weather is usually cold and ---------------",
    a: "d",
    options: ["scorching", "hot", "dry", "rainy"]
  },
  {
    q: "22- I always do my own homework ------------night.",
    a: "c",
    options: ["on", "in", "at", "of"]
  },
  {
    q: "23- It's raining, ---------------I am in a bad need for an umbrella.",
    a: "c",
    options: ["and", "but", "so", "however"]
  },
  {
    q: "24- I ------------------a T-shirt and shorts at the moment.",
    a: "c",
    options: ["wore", "wear", "am wearing", "wearing"]
  },
  {
    q: "25- It's ten o'clock ----------------the morning.",
    a: "b",
    options: ["on", "in", "at", "from"]
  },
  {
    q: "26- It's half --------eleven. It's too early to move.",
    a: "b",
    options: ["to", "past", "before", "at"]
  },
  {
    q: "27- My brother's son is my ---------------. I love him very much.",
    a: "b",
    options: ["niece", "nephew", "cousin", "daughter"]
  },
  {
    q: "28- I don't ------------------to work in the morning as it's very hot.",
    a: "b",
    options: ["walks", "walk", "walking", "walked"]
  },
  {
    q: "29- He lives in the --------------because he believes that they are better than the downtown.",
    a: "b",
    options: ["city", "suburbs", "urban", "station"]
  },
  {
    q: "30- Do you go to bed --------------late on weekends? Yes, I do.",
    a: "a",
    options: ["no preposition", "on", "in", "at"]
  },
  {
    q: "31- I get up early -----------Mondays. It's my custom.",
    a: "b",
    options: ["in", "on", "at", "of"]
  },
  {
    q: "32- Sam is Sarah's husband. Sarah is Sam's ---------------------",
    a: "a",
    options: ["wife", "sister", "daughter", "mother"]
  },
  {
    q: "33- We use the public ---------------. We take the bus, the train, or the subway.",
    a: "c",
    options: ["translation", "transferring", "transportation", "transplanting"]
  },
  {
    q: "34- My -----------------------is big and my wardrobe is spacious. I have a wide bed.",
    a: "d",
    options: ["dining room", "kitchen", "bathroom", "bedroom"]
  },
  {
    q: "35- A: Does your father do a lot of work at home? B: -------------------------",
    a: "b",
    options: ["yes, I do", "yes, he does", "yes, he has", "yes, he did"]
  },
  {
    q: "36- In Roger's house, there -------------------a big living room.",
    a: "c",
    options: ["are", "aren't", "is", "were"]
  },
  {
    q: "37- We keep our food valid in the --------------------",
    a: "a",
    options: ["fridge", "toilet", "iron", "cook"]
  },
  {
    q: "38- A: ---------------------------? B: No, I don't live alone. I live with my family.",
    a: "b",
    options: ["Are you living alone", "Do you live alone", "Does he live alone", "Is he living alone"]
  },
  {
    q: "39- A: My apartment has a view of the river. B: --------------------------------",
    a: "b",
    options: ["Guess what!", "You're lucky", "It's too late", "I don't like the food"]
  },
  {
    q: "40- She's a -------------------. She helps patients at hospitals.",
    a: "c",
    options: ["engineer", "carpenter", "nurse", "baker"]
  },
  {
    q: "41- My brother is a salesperson. He works in a --------------------------",
    a: "b",
    options: ["restaurant", "department store", "school", "police station"]
  },
  {
    q: "42- A flight attendant has an exciting job. A flight attendant doesn't have a --------------job.",
    a: "c",
    options: ["interesting", "fabulous", "boring", "marvelous"]
  },
  {
    q: "43- What do you do, exactly? I'm a -----------------",
    a: "b",
    options: ["cupboard", "lawyer", "bin", "stove"]
  },
  {
    q: "44- The ----------------collects the news and sends them to the newspaper.",
    a: "b",
    options: ["pilot", "reporter", "model", "athlete"]
  },
  {
    q: "45- It's a stressful job. And it's pretty ---------------------",
    a: "c",
    options: ["relaxing", "calm", "dangerous", "fixed"]
  },
  {
    q: "46- The --------------------carry luggage for the people in hotels.",
    a: "b",
    options: ["painter", "bellhop", "vendor", "plumber"]
  },
  {
    q: "47- I can wear my clothes and arrange my make-up at the ---------------",
    a: "b",
    options: ["sofa", "dresser", "bookcase", "rug"]
  },
  {
    q: "48- I really need -------------------furniture.",
    a: "a",
    options: ["some", "many", "few", "any"]
  },
  {
    q: "49- -----------------------is the capital of Saudi Arabia.",
    a: "b",
    options: ["Cape Town", "Riyadh", "Jeddah", "Dammam"]
  },
  {
    q: "50- It's cold today, but Kathy -------------------a coat.",
    a: "a",
    options: ["isn't wearing", "is wearing", "wears", "wore"]
  }
];




    
        let currentTFQuestion = 0;
        let tfCorrectAnswers = 0;
        let currentQuestion = 0;
        let correctAnswers = 0;
        let timeLeft = 3600;
        let timerInterval;
        let startTime;
    
        function startQuiz() {
    let name = document.getElementById("traineeName").value.trim();
    let phone = document.getElementById("traineePhone").value.trim();
    let password = document.getElementById("password").value;
    let course = document.getElementById("courseName").value.trim(); // 🆕 قراءة اسم الكورس
    let quizTitle = document.getElementById("quizTitle"); // 🆕 العنوان اللي هيتغير

    if (!name) {
        alert("❗ برجاء إدخال الاسم.");
        return;
    }

    if (!phone) {
        alert("❗ برجاء إدخال رقم التليفون.");
        return;
    }

    if (password !== "1550") {
        alert("❌ كلمة المرور غير صحيحة! الرجاء المحاولة مرة أخرى.");
        return;
    }

    // 🆕 تغيير العنوان بناءً على اسم الكورس
    quizTitle.textContent = course || "Placement Test";

    document.getElementById("startScreen").style.display = "none";
    document.getElementById("quizContainer").style.display = "block";
    startTime = new Date();
    startTimer();
    loadTFQuestion();

    // تشغيل وضع ملء الشاشة
    let elem = document.documentElement;
    if (elem.requestFullscreen) {
        elem.requestFullscreen();
    } else if (elem.mozRequestFullScreen) {
        elem.mozRequestFullScreen();
    } else if (elem.webkitRequestFullscreen) {
        elem.webkitRequestFullscreen();
    } else if (elem.msRequestFullscreen) {
        elem.msRequestFullscreen();
    }
}



    
        function startTimer() {
            timerInterval = setInterval(() => {
                let minutes = Math.floor(timeLeft / 60);
                let seconds = timeLeft % 60;
                document.getElementById("timer").innerText = `Time Remaining: ${minutes}:${seconds < 10 ? '0' : ''}${seconds}`;
                if (timeLeft <= 0) {
                    clearInterval(timerInterval);
                    showResult();
                }
                timeLeft--;
            }, 1000);
        }
    
      function loadTFQuestion() {
    let quizDiv = document.getElementById("quiz");
    let passageDiv = document.getElementById("passage");

    if (currentTFQuestion < trueFalseQuestions.length) {
        let q = trueFalseQuestions[currentTFQuestion];

        // عرض المقطع
        passageDiv.innerHTML = `
            <h3>Read the following passage carefully and answer the question:</h3>
            <p style="font-size: 22px;">${q.passage}</p>
        `;

        // عرض السؤال والاختيارات
        let questionHTML = `<p class='question'><strong>${currentTFQuestion + 1}- ${q.q}</strong></p>`;

        q.options.forEach((option, index) => {
    const letter = String.fromCharCode(97 + index); // "a", "b", ...
    questionHTML += `
        <label>
            <input type='radio' name='answer' value='${letter}'>
            ${option}
        </label><br>
    `;
});

        questionHTML += `<button class='btn' onclick='nextTFQuestion()'>Next</button>`;
        quizDiv.innerHTML = questionHTML;
    } else {
        // الانتهاء من عرض كل الأسئلة
        document.getElementById("passage").style.display = "none";
        quizDiv.innerHTML = "<p>You've finished all reading questions.</p>";
        loadQuestion(); // لو فيه مرحلة تانية
    }
}

    
  function nextTFQuestion() {
  const selectedAnswer = document.querySelector("input[name='answer']:checked");
  if (!selectedAnswer) {
    alert("Please select an answer");
    return;
  }

  const q = trueFalseQuestions[currentTFQuestion];
  const selectedValue = selectedAnswer.value;

  const isAnswerKeyALetter = q.a.length === 1 && ["a", "b", "c", "d"].includes(q.a.toLowerCase());

  if (isAnswerKeyALetter) {
    if (selectedValue === q.a.toLowerCase()) {
      tfCorrectAnswers++; // ✅ صحح هنا بدل score
    }
  } else {
    const selectedOptionIndex = selectedValue.charCodeAt(0) - 97;
    const selectedOptionText = q.options[selectedOptionIndex];

    if (selectedOptionText.trim().toLowerCase() === q.a.trim().toLowerCase()) {
      tfCorrectAnswers++; // ✅ صحح هنا بدل score
    }
  }

  currentTFQuestion++;
  loadTFQuestion();
}




        function loadQuestion() {
            let quizDiv = document.getElementById("quiz");
            let q = questions[currentQuestion];
            quizDiv.innerHTML = `<p class='question'>${q.q}</p>` +
                q.options.map((option, index) => `<label><input type='radio' name='answer' value='${String.fromCharCode(97 + index)}'> ${option}</label>`).join('') +
                `<button class='btn' onclick='nextQuestion()'>${currentQuestion === questions.length - 1 ? "Finish" : "Next"}</button>`;
        }
    
        function nextQuestion() {
            let selectedAnswer = document.querySelector("input[name='answer']:checked");
            if (!selectedAnswer) return;
            if (selectedAnswer.value === questions[currentQuestion].a) {
                correctAnswers++;
            }
            if (currentQuestion < questions.length - 1) {
                currentQuestion++;
                loadQuestion();
            } else {
                showResult();
            }
        }
    
let serverUrl = ""; // سيتم تحديثه تلقائيًا عند تحميل الصفحة

// دالة لجلب رابط السيرفر المخزن في GitHub
function fetchServerUrl() {
fetch("https://raw.githubusercontent.com/etiqotwf/liveServer1/main/serverUrl.json")
        .then(response => response.json())
        .then(data => {
            if (data.serverUrl) {
                serverUrl = data.serverUrl;
                console.log("✅ رابط السيرفر المحدث من GitHub:", serverUrl);
            } else {
                console.error("❌ لم يتم العثور على رابط السيرفر في المستودع.");
                retryFetchServerUrl();
            }
        })
        .catch(error => {
            console.error("❌ خطأ في جلب رابط السيرفر من GitHub:", error);
            retryFetchServerUrl();
        });
}

// دالة لإعادة المحاولة عند الفشل
function retryFetchServerUrl() {
    if (retryCount < MAX_RETRIES) {
        retryCount++;
        console.log(`🔄 إعادة المحاولة (${retryCount}/${MAX_RETRIES}) بعد 3 ثوانٍ...`);
        setTimeout(fetchServerUrl, 3000);
    } else {
        console.error("⛔ تم الوصول إلى الحد الأقصى من المحاولات، تعذر جلب رابط السيرفر.");
    }
}

// تحميل رابط السيرفر عند فتح الصفحة
fetchServerUrl();

function showResult() {
    clearInterval(timerInterval);

    let endTime = new Date();
    let timeTaken = Math.floor((endTime - startTime) / 1000);
    let minutesTaken = Math.floor(timeTaken / 60);
    let secondsTaken = timeTaken % 60;

    let name = document.getElementById("traineeName").value || "Unknown";
    let phone = document.getElementById("traineePhone").value || "Unknown";
    let date = new Date().toLocaleDateString("en-US");
    let course = document.getElementById("courseName").value || "Unknown";

    let totalQuestions = trueFalseQuestions.length + questions.length;
    let totalCorrectAnswers = tfCorrectAnswers + correctAnswers;

    let resultData = {
        name: name,
        phone: phone,
        date: date,
        course: course,
        startTime: startTime.toLocaleString("en-GB", {
            timeZone: "Africa/Cairo",
            year: "numeric",
            month: "long",
            day: "numeric",
            hour: "numeric",
            minute: "numeric",
            second: "numeric",
            hour12: true
        }),
        timeTaken: `${minutesTaken} min ${secondsTaken} sec`,
        score: `${totalCorrectAnswers} / ${totalQuestions}`
    };

    // إرسال البيانات إلى السيرفر إذا تم تحميل الرابط
    if (!serverUrl) {
        console.log("⏳ انتظار تحميل رابط السيرفر...");
        fetchServerUrl().then(() => {
            if (serverUrl) {
                sendDataToServer(resultData);
            } else {
                console.error("❌ لم يتم تحميل رابط السيرفر بعد.");
                alert("⚠️ تعذر إرسال البيانات! تأكد من اتصال الإنترنت وأعد المحاولة.");
            }
        });
    } else {
        sendDataToServer(resultData);
    }

    // إرسال البيانات إلى Google Sheets
    sendDataToGoogleSheet(resultData);

    // تحديث واجهة المستخدم
    document.getElementById("resultCourse").innerText = course;
    document.getElementById("resultName").innerText = name;
    document.getElementById("resultPhone").innerText = phone;
    document.getElementById("resultDate").innerText = date;
    document.getElementById("resultStartTime").innerText = startTime.toLocaleTimeString();
    document.getElementById("resultTime").innerText = `${minutesTaken} min ${secondsTaken} sec`;
    document.getElementById("resultScore").innerText = `${totalCorrectAnswers} / ${totalQuestions}`;

    document.getElementById("quizContainer").style.display = "none";
    document.getElementById("resultScreen").style.display = "block";
}

// إرسال البيانات إلى السيرفر الأساسي
function sendDataToServer(resultData) {
    fetch(`${serverUrl}/submit`, {
        method: "POST",
        headers: {
            "Content-Type": "application/json"
        },
        body: JSON.stringify(resultData)
    })
    .then(response => response.json())
    .then(data => console.log("✅ تم الإرسال إلى السيرفر بنجاح:", data))
    .catch(error => console.error("❌ خطأ أثناء الإرسال إلى السيرفر:", error));
}





function sendDataToGoogleSheet(resultData) {
    const formData = new URLSearchParams();
    formData.append("course", resultData.course);
    formData.append("name", resultData.name);
    formData.append("phone", resultData.phone);
    formData.append("date", resultData.date);
    formData.append("startTime", resultData.startTime);
    formData.append("timeTaken", resultData.timeTaken);
    formData.append("score", resultData.score);
    formData.append("course", resultData.course);


    fetch("https://script.google.com/macros/s/AKfycbybhyNx3uPAoAjGlvHe_jumSp_NKeOIIwoAPHWOqzUukmlmtoTlE5wF8Y_w17l5m9FS/exec", {
        method: "POST",
        headers: {
            "Content-Type": "application/x-www-form-urlencoded",
        },
        body: formData.toString(),
    })
    .then(response => response.text())
    .then(responseText => {
        console.log("✅ تم الإرسال إلى Google Sheet:", responseText);
    })
    .catch(error => {
        console.error("❌ خطأ في الإرسال إلى Google Sheet:", error);
    });
}




    </script>
    </body>
</html>
